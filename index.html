<!DOCTYPE html>
<!-- Coding by CodingNepal || www.codingnepalweb.com -->
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Boxicons CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <title>Quality and Trust Solution Documentation</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- navbar -->
    <nav class="navbar">
      <div class="logo_item">
        <i class="fa-solid fa-bars" id="sidebarOpen"></i>
        <!-- <img src="images/logo.png" alt=""></i> -->
        Quality and Trust Solution
      </div>

      <div class="search_bar">
        <!-- <input type="text" placeholder="Search" /> -->
      </div>

      <div class="navbar_content">
        <i class="bi bi-grid"></i>
        <i class="fa-solid fa-sun" id="darkLight"></i>
        <img src="images/profile.jpg" alt="" class="profile" />
      </div>
    </nav>

    <!-- sidebar -->
    <nav class="sidebar">
      <div class="menu_content">
        <ul class="menu_items">
          

          <div class="menu_title menu_dahsboard"></div>
          <!-- start -->
          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-house"></i>
              </span>
              <span class="navlink">Home</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink qts" onClick="clickCalled('qts')">Quality & Trust Solution</a>
              <a href="#" class="nav_link sublink intro" onClick="clickCalled('intro')">Introduction</a>
              <a href="#" class="nav_link sublink busRel" onClick="clickCalled('busRel')">Business Relevance</a>
              <a href="#" class="nav_link sublink relUC" onClick="clickCalled('relUC')">Relevant Use cases</a>
            </ul>
          </li>
          <!-- end -->

          <!-- start -->
          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-screwdriver-wrench"></i>
              </span>
              <span class="navlink">Installation</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink preReq" onClick="clickCalled('preReq')">Prerequisite</a>
              <a href="#" class="nav_link sublink packIns" onClick="clickCalled('packIns')">Package Installation</a>
              <a href="#" class="nav_link sublink errRes" onClick="clickCalled('errRes')">Error Resolution</a>
            </ul>
          </li>
          <!-- end -->

          <!-- start -->
          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-sliders"></i>
              </span>
              <span class="navlink">Configuration</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink llm" onClick="clickCalled('llm')">LLM Model Config</a>
              <a href="#" class="nav_link sublink dbConf" onClick="clickCalled('dbConf')">Database Config:</a>
              <a href="#" class="nav_link sublink setDb" onClick="clickCalled('setDb')">Setup database & use Lib</a>
              <a href="#" class="nav_link sublink mmc" onClick="clickCalled('mmc')">Metric/Metadata Config</a>
            </ul>
          </li>
          <!-- end -->

          <!-- start -->
          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-handshake"></i>
              </span>
              <span class="navlink">How to use QT</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink qtLib" onClick="clickCalled('qtLib')">How to use QT Lib</a>
              <a href="#" class="nav_link sublink errResolution" onClick="clickCalled('errResolution')">Error Resolution</a>
              <a href="#" class="nav_link sublink fnq" onClick="clickCalled('fnq')">F&Q</a>
            </ul>
          </li>
          <!-- end -->
        </ul>

        <ul class="menu_items">
          <div class="menu_title menu_editor"></div>
          <!-- duplicate these li tag if you want to add or remove navlink only -->
          <li class="item">
            <a href="#" class="nav_link matrIntro" onClick="clickCalled('matrIntro')">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Introduction</span>
            </a>
          </li>

          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Application</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink matrCost" onClick="clickCalled('matrCost')">Cost</a>
            </ul>
          </li>
<!-- Response_QA Start -->
          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Response_QA</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrQA_exact" onClick="clickCalled('matrQA_exact')">Accuracy</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrQA_complete" onClick="clickCalled('matrQA_complete')">Relevancy</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrQA_hallucination" onClick="clickCalled('matrQA_hallucination')">Hallucination</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrQA_syntax" onClick="clickCalled('matrQA_syntax')">Robustness</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrQA_Latency" onClick="clickCalled('matrQA_Latency')">Efficiency</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrQA_gender" onClick="clickCalled('matrQA_gender')">Bias</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrQA_toxic" onClick="clickCalled('matrQA_toxic')">Toxicity</span>
            </ul>
          </li>
<!-- Response_QA End -->
<!-- Response_summarization Start -->
          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Response_Summarize</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrSum_agreement" onClick="clickCalled('matrSum_agreement')">Accuracy</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrSum_supert" onClick="clickCalled('matrSum_supert')">Relevancy</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrSum_hallucination" onClick="clickCalled('matrSum_hallucination')">Hallucination</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrSum_coherance" onClick="clickCalled('matrSum_coherance')">Robustness</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrSum_cost" onClick="clickCalled('matrSum_cost')">Efficiency</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrSum_gender" onClick="clickCalled('matrSum_gender')">Bias</span>
            </ul>

            <ul class="menu_items submenu">
              <span class="nav_link sublink matrSum_toxic" onClick="clickCalled('matrSum_toxic')">Toxicity</span>
            </ul>
          </li>
<!-- Response_summarization End -->
          <li class="item">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Search</span>
              <i class="fa-solid fa-chevron-right arrow-right"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink matrHitrate" onClick="clickCalled('matrHitrate')">Hit Rate</a>
            </ul>
            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink matrBinary" onClick="clickCalled('matrBinary')">Binary Preference</a>
            </ul>
            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink matrSearch" onClick="clickCalled('matrSearch')">Search Reliability</a>
            </ul>
          </li>

          <li class="item">
            <div href="#" class="nav_link submenu_item matrData" onClick="clickCalled('matrData')">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Data Quality</span>
              <!-- <i class="fa-solid fa-chevron-right arrow-right"></i> -->
            </div>
          </li>

          <li class="item">
            <div href="#" class="nav_link submenu_item matrClassification" onClick="clickCalled('matrClassification')">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Classification</span>
              <!-- <i class="fa-solid fa-chevron-right arrow-right"></i> -->
            </div>
          </li>

          <li class="item">
            <div href="#" class="nav_link submenu_item matrExperiment" onClick="clickCalled('matrExperiment')">
              <span class="navlink_icon">
                <i class="fa-solid fa-circle"></i>
              </span>
              <span class="navlink">Experiment Tracking</span>
              <!-- <i class="fa-solid fa-chevron-right arrow-right"></i> -->
            </div>
          </li>

        </ul>
        <ul class="menu_items">
          <div class="menu_title menu_model_benchmarking"></div>
        </ul>
        <ul class="menu_items">
          <div class="menu_title menu_ref"></div>
        </ul>

        <!-- Sidebar Open / Close -->
        <!-- <div class="bottom_content">
          <div class="bottom expand_sidebar">
            <span> Expand</span>
            <i class='bx bx-log-in' ></i>
          </div>
          <div class="bottom collapse_sidebar">
            <span> Collapse</span>
            <i class='bx bx-log-out'></i>
          </div>
        </div> -->
      </div>
    </nav>
    <div id="maincontent">
      <div id="default">
        <h2 class="pageTitle">Quality & Trust Solution</h2>
CitiusTech's Healthcare GenAI Quality & Trust Solution is a software-based framework to design, develop, integrate, and monitor quality and trust of GenAI applications in healthcare to drive enterprise adoption and scaling.<br><br>QT solution is an evaluator to assess the performance and effectiveness of applications utilizing LLMs for the tasks: question answering, summarization, classification and NER & entity extraction. Also evaluates the search and retrieval part of a RAG application. Perform reference free evaluations of parts of the RAG pipeline. These metrics can be a part of CI/CD pipelines for improving prompts for entity extraction, response quality, search quality and application quality during development.
      </div>

      <div id="qts">
        <h2 class="pageTitle">Quality & Trust Solution</h2>
CitiusTech's Healthcare GenAI Quality & Trust Solution is a software-based framework to design, develop, integrate, and monitor quality and trust of GenAI applications in healthcare to drive enterprise adoption and scaling.<br><br>QT solution is an evaluator to assess the performance and effectiveness of applications utilizing LLMs for the tasks: question answering, summarization, classification and NER & entity extraction. Also evaluates the search and retrieval part of a RAG application. Perform reference free evaluations of parts of the RAG pipeline. These metrics can be a part of CI/CD pipelines for improving prompts for entity extraction, response quality, search quality and application quality during development.
      </div>

      <div id="intro">
        <h2 class="pageTitle">Introduction</h2>
<b>Citiustech Healthcare GENAI Quality & Trust (Q&T) Framework</b> is a software-based solution designed to ensure the quality, reliability, and trustworthiness of Generative AI (GENAI) applications in the healthcare industry. As organizations increasingly adopt AI-driven solutions, particularly Large Language Models (LLMs), it becomes crucial to monitor and assess their performance. The Q&T Framework is built to evaluate applications that leverage LLMs for critical tasks like question answering, summarization, classification, Named Entity Recognition (NER), and entity extraction.
<br><br> framework is pivotal for organizations aiming to implement and scale GENAI applications within healthcare ecosystems. By integrating the Q&T Framework into the Continuous Integration/Continuous Deployment (CI/CD) pipeline, healthcare organizations can monitor, improve, and optimize the quality of AI-generated outputs, ensuring regulatory compliance, enhanced accuracy, and ultimately better patient outcomes.        
      </div>

      <div id="busRel">
        <h2 class="pageTitle">Business Relevance</h2>
Generative AI is revolutionizing healthcare, from automating administrative tasks to assisting with clinical decision-making. However, its successful enterprise-wide adoption hinges on ensuring the quality, accuracy, and trustworthiness of AI-driven applications. The Citiustech Healthcare GENAI Quality & Trust Framework addresses this need by providing a structured, evaluative approach that organizations can use to: <br>
• <b>Mitigate Risks:</b> Ensure that AI models are accurate, transparent, and ethical, thereby mitigating risks associated with incorrect or biased outputs in healthcare scenarios.
• <b>Enhance Trust:</b> Build trust among healthcare providers and patients by ensuring that AI-driven decisions are reliable and aligned with healthcare standards and regulations.
• <b>Optimize Performance:</b> The framework evaluates model effectiveness during development and post-deployment, improving performance in real time by identifying areas for prompt enhancement and error correction.
• <b>Accelerate Scaling:</b> By integrating the framework into CI/CD pipelines, organizations can streamline the development and deployment process, facilitating large-scale adoption of GENAI applications across multiple healthcare use cases.
<br>With a focus on tasks like question answering, summarization, classification, NER, entity extraction, and RAG (Retrieval-Augmented Generation) applications, the Q&T Framework supports ongoing AI model refinement, making it a vital tool for scaling AI innovations in healthcare.
      </div>

      <div id="relUC">
        <h2 class="pageTitle">Relevant Use Cases</h2>
<i>1. Question Answering for Clinical Decision Support</i>
<b>• Challenge:</b> Healthcare professionals often rely on AI models to provide fast, accurate answers to complex medical questions based on large datasets of clinical knowledge. Ensuring the quality and reliability of these answers is critical for patient safety.
<b>• Solution:</b> The Q&T Framework evaluates the effectiveness of LLMs in clinical question-answering tasks, ensuring that responses are accurate, relevant, and free from bias. Continuous evaluation helps refine model responses over time, improving clinical decision-making.
<br><i>2. Summarization of Medical Records</i>
<b>• Challenge:</b> Healthcare providers require concise, accurate summaries of extensive patient medical records, which are often generated by AI systems. Errors in summarization can lead to missed diagnoses or incorrect treatment plans.
<b>• Solution:</b> The Q&T Framework assesses the quality of summarizations produced by GENAI models, ensuring the summaries are clear, comprehensive, and medically accurate. The evaluation results can be used to fine-tune summarization models to better meet clinical requirements.
<br><i>3. Classification of Medical Data</i>
<b>• Challenge:</b> In applications like diagnostic tools and medical billing, AI models must accurately classify medical data (e.g., images, clinical notes) into predefined categories. Misclassification can result in incorrect diagnoses or billing errors.
<b>• Solution:</b> The Q&T Framework evaluates the precision, recall, and overall accuracy of classification models, allowing healthcare organizations to monitor and improve model performance, ensuring data is classified correctly.
<br><i>4. Named Entity Recognition (NER) and Entity Extraction from Clinical Texts</i>
<b>• Challenge:</b> AI systems in healthcare must accurately identify medical entities (e.g., diseases, drugs, symptoms) from unstructured clinical notes or research papers. Errors in NER or entity extraction can lead to incomplete patient data or incorrect analytics.
<b>• Solution:</b> The Q&T Framework assesses the quality of NER and entity extraction tasks, ensuring that models accurately recognize and extract relevant entities from text. By integrating this into the CI/CD pipeline, developers can continuously improve the performance of NER models.
<br><i>5. Search and Retrieval for RAG (Retrieval-Augmented Generation) Applications</i>
<b>• Challenge:</b> In RAG applications, LLMs rely on search and retrieval functions to generate relevant and accurate responses. Poor search results can lead to incomplete or incorrect AI outputs.
<b>• Solution:</b> The Q&T Framework evaluates the effectiveness of the search and retrieval process in RAG applications. By continuously monitoring this aspect, the framework ensures that LLMs retrieve the most relevant information, improving overall response quality in GENAI applications.

How the Q&T Framework Supports Development and Scaling
<b>• Reference-Free Evaluation:</b> The Q&T Framework can perform reference-free evaluations of specific components in the RAG pipeline. This means that the framework can assess model outputs without needing predefined correct answers, making it versatile in evaluating complex, open-ended tasks such as summarization or question answering.
<b>• CI/CD Pipeline Integration:</b> By incorporating evaluation metrics into the CI/CD pipelines, developers can automatically monitor and improve the quality of entity extraction, response quality, and search performance as new iterations of the AI model are deployed. This real-time feedback mechanism ensures that healthcare AI applications continuously evolve and improve in terms of accuracy, relevance, and trustworthiness.
<b>• Metrics for Trust and Quality:</b> The framework provides actionable metrics that help developers assess the quality and trust of the AI applications they are building. These metrics can drive prompt engineering, improving model performance at every stage of the AI lifecycle.
      </div>

      <div id="preReq">
        <h2 class="pageTitle">Prerequisite</h2>
• Python Version 3.10.* to 3.11.*

• MySQL Workbench

• Postgres

• Environment variables to be set and configured. Refer to Configurations for further steps.
      </div>

      <div id="packIns">
        <h2 class="pageTitle">Package Installation</h2>
<b>Steps:-</b>

<b>Step 1:</b> Get access to Quality & Trust gitlab repository. Download Q&T package wheel file from https://git/generativeai/genai-trust-framework/-/tree/QT_backend/dist

<b>Step 2:</b> For Package Installation, create a new virtual environment and activate it or install the package in existing application environment.

<b>Step 3:</b> To install wheel file, execute below command -
<b>pip install qualitytrust-1.0-py3-none-any.whl</b>

All the libraries will be installed with dependencies.

<b>Note -</b> if you face any issue while installation, please refer to error resolution page (link).
      </div>

      <div id="errRes">
        <h2 class="pageTitle">Error Resolution</h2>
Error : Visual Build Tool error
Solution : Download and install visual C++ build tool

Error : Python package dependency errors
Solution : Downgrade/upgrade common packages.        
      </div>

      <div id="llm">
        <h2 class="pageTitle">LLM Model Config</h2>
<b>Environment Variables</b>
There are two types of metrics in the Q&T solution package: reference based and reference free metrics. Reference based metrics need a ground truth against which to evaluate the application response. Reference free metrics in the Q&T solution are evaluated using LLMs. These metrics align with human expectations and can be computed using any LLM. An LLM is a Judge for evaluation of these non-ground truth based/ reference free metrics. The user can switch between different models or even open source LLMs by providing the model details. Following are the methods to set up / configure the models and to setup environment variables.

<b>For Azure OpenAI model:</b>
Run the following commands to configure your environment to use AzureOpenAI models for all LLM-based metrics. To use AzureOpenAI models for evaluation, supply the model details as below:
• os.environ["MODEL_TYPE"] = "azure"
• os.environ["AZURE_OPENAI_API_KEY"] = "1213jaj...." 
• os.environ["Azure_OPENAI_VERSION"] = ""
• os.environ["AZURE_API_BASE_URL"] = ""
• os.environ["AZURE_MODEL_DEPLOYMENT_NAME"] ="davinci"

<b>For OpenAI models :</b> 
• os.environ["MODEL_TYPE"] = "openai"
• os.environ["OPENAI_API_KEY"] = "sk-..."
• os.environ["OPENAI_MODEL_NAME"] = ""

<b>For Anthropic Claude models:</b>
• os.environ["MODEL_TYPE"] = "claude"
• os.environ["ANTHROPIC_API_KEY"] = "sk-..."
• os.environ["CLAUDE_MODEL_NAME"] = ""

<b>For Mistral models:</b>
• os.environ["MODEL_TYPE"] = "mistral"
• os.environ["MISTRAL_API_KEY"] = "sk-..."
• os.environ["MISTRAL_MODEL_NAME"] = ""

<b>For Ollama models:</b> 
  Run the following commands to configure your environment to use an open source model for all LLM-based metrics. Quantized models can be used on the CPU without high latency/ without increasing computational costs. Some models that you can try are: Llama 3.1, MS phi3.5 mini etc
• os.environ["MODEL_TYPE"] = "ollama"
• os.environ["OLLAMA_MODEL_NAME"] = ""

<b>For AWS Bedrock models:</b>
• os.environ["MODEL_TYPE"] = "bedrock"
• os.environ["AWS_ACCESS_KEY_ID"] = ""
• os.environ["AWS_SECRET_ACCESS_KEY"] = ""
• os.environ["AWS_REGION_NAME"] = ""
• os.environ["BEDROCK_MODEL_NAME"] = ""
      </div>

      <div id="dbConf">
        <h2 class="pageTitle">Database Config</h2>
To integrate Q&T with any application, we need database to store evaluation scores that can be visualized in dashboard. Hence, we need to set environment variables to configure

<b>For mysql database:</b>
• os.environ["DB_TYPE"] = "mysql"
• os.environ["MYSQL_USER"] = ""
• os.environ["MYSQL_PASSWORD"] = ""
• os.environ["MYSQL_HOST"] = ""
• os.environ["MYSQL_PORT"] = "3306"
• os.environ["MYSQL_DB_NAME"] = ""

<b>For postgres database:</b>
• os.environ["DB_TYPE"] = "postgres"
• os.environ["POSTGRES_USER"] = ""
• os.environ["POSTGRES_PASSWORD"] = ""
• os.environ["POSTGRES_HOST"] = ""
• os.environ["POSTGRES_PORT"] = "5432"
• os.environ["POSTGRES_NAME"] = ""

<b>For mssql database:</b>
• os.environ["DB_TYPE"] = "mssql"
• os.environ["MSSQL_USER"] = ""
• os.environ["MSSQL_PASSWORD"] = ""
• os.environ["MSSQL_HOST"] = ""
• os.environ["MSSQL_PORT"] = "1433"
• os.environ["MSSQL_NAME"] = ""

<b>For oracle database :</b>
• os.environ["DB_TYPE"] = "oracle"
• os.environ["ORACLE_USER"] = ""
• os.environ["ORACLE_PASSWORD"] = ""
• os.environ["ORACLE_HOST"] = ""
• os.environ["ORACLE_PORT"] = "1521"
• os.environ["ORACLE_NAME"] = ""


<b>For databricks database :</b>
• os.environ["DB_TYPE"] = "delta_table"
• os.environ["DATABRICKS_HTTP_PATH"] = ""
• os.environ["DATABRICKS_ACCESS_TOKEN"] = ""
• os.environ["DATABRICKS_HOST"] = ""
• os.environ["DATABRICKS_CATALOG"] = ""
• os.environ["DATABRICKS_SCHEMA"] = ""

If none of the above databases is used, by default sqlite database is used and quality_trust.db is created.
      </div>

      <div id="setDb">
        <h2 class="pageTitle">How to setup database and use library?</h2>
<b>How to setup database</b>

• Install any of the database tools like postgres, MySQL workbench/server, MS SQL, Oracle etc. 

• Setup credentials in the tool and accordingly change the database configuration (link of db config)

• Create a database in database tool and update database name in database configuration (link)

• To create schema, follow these steps - 

<b>Steps to create schema</b>
Run the following python commands -  

<b>#Import below library from qualitytrust</b>
from qualitytrust import model

<b>#Execute the following command</b>
model.create_schema()


<b>Insert metadata in database</b>
With this metadata following tables will be loaded -
applications
metric_type
metrics
metric_mapping

Format of the schema which is provided explicitly should be as below –

- application: name_of_the_application
app_description: GenAI tool which assist clinical reviewers in decision support through infornation retrieval, extraction and accessing medical necessity of requested services
mapping:
- metric_type: Application
metrics:
- metric_class: A.F.T.R
description: ""
task: All
metric_name: A.F.T.R
soft_threshold: 0.7
hard_threshold: 0.4

This data should be in metric_config.yml file as per the requirements.

<b>Logging metadata in database</b>
Use the following commands to log metadata into the database using qualitytrust package

<b>#Import log metadata library </b>
from app.qualitytrust.suite.log_metadata import LogMetadata

<b>#Run the python commands</b>
log_metadata = LogMetadata()
log_metadata.log(metadata_path="app/qualitytrust/config/metric_config.yml")

      </div>

      <div id="mmc">
        <h2 class="pageTitle">Metric / Metadata Config</h2>
      </div>

      <div id="qtLib">
        <h2 class="pageTitle">How to use QualityTrust library ?</h2>
Here is an example to showcase how you can use the library to evaluate various metrics such as Factual Accuracy, Response Relevance, Response Completeness, Hallucination Degree, Context Disregard, Language Critique, Gender and Racial Bias, Honest Score, Toxic Opinions. 

<b>We have a dict data containing query, response and context -</b>
data = [{
"question": "What is the size of hernia sac?",
"response": "The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions.",
"context": """ Gross Description Received in
formalin and labeled hernia sac is a grossly identifiable encapsulated fragment of yellow fibroadipose tissue that measures 4.5 x 1.5 x 0.6 cm in widest dimensions. The specimen is cross sectioned which reveals a surface that is homogeneously balanced and encapsulated with a thin tan-brown membranous material"""
},{
"question": "What are the treatments given to john Brown?",
"context": """Repair of recurrent right inguinal hernia. HISTORY AND INDICATIONS FOR ADMISSION: Mr. Brown is a 54-year-old white male who presented with pain to Dr. Jeff Moore. He had a hernia repair, on the right, in the past, and this was recurrent. He was scheduled for surgery. HOSPITAL COURSE: The patient was admitted on 11/12/1999 and underwent surgery, and did fine. He was transferred to the floor. On 11/13/99 he is alert, awake, afebrile, taking a regular diet. Having bowel movements, and passing his urine normally. His incision is clean and dry. He is discharged home in satisfactory condition with Lortab PRN for pain. He is to follow up with his primary care physician, Dr. Moore, on Monday. D: 11/13/1999 T: 11/16/1999 wms cc: Jeff T. Moore, M.D. Tom W. Smith, M.D. Community General Hospital Anytown, USA HISTORY AND
PHYSICAL Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Page 1 of 2 REASON FOR ADMISSION: This is a 54 year old male, admitted here for repair of right inguinal hernia. HISTORY OF PRESENT ILLNESS: The patient has
had his hernia repaired in the past, elsewhere. Over the past number of months, he has seen this hernia come back and recur, and become larger. It causes discomfort. He is admitted for repair of a right inguinal hernia. PAST MEDICAL HISTORY: Denies. MEDICATIONS: None. PAST SURGICAL HISTORY: Hernia surgery on the right in the past. The patient also has had a left inguinal hernia repair in the past""", 
"response": "John Brown underwent surgery for a recurrent hernia repair. It is not specified what other treatments, if any, were given to him."
}]

To evaluate metrics import the following library from qualitytrust package
from app.qualitytrust.bench import Evaluate

<b>Score can be calculated using - </b>
score = Evaluate.evaluate_dataset(dataset=data,metrics=["Factual Accuracy","Response Relevance","Response Completeness","Hallucination Degree","Context Disregard", "Language Critique","Gender and Racial Bias","Honest Score","Toxic Opinions"]) 
      </div>

      <div id="matrIntro">
        <h2 class="pageTitle">Introduction</h2>
<img src="images/matrIntro.png">
      </div>

      <div id="matrCost">
        <h2 class="pageTitle">Cost</h2>
Measures the total cost for a GenAI application. The cost of a Generative AI application involves expenses related to application usage such as the following:<br>
<b>Compute resources:</b> CPU, memory, or GPU hours used by the application for generating output.
<b>Infrastructure costs:</b> If running the GenAI model locally using cloud services like AWS, Google Cloud Platform, or Azure, consider their pricing tiers and compute instance rates.
<b>Software licensing fees:</b> Depending on how you're accessing the GenAI application, there might be subscription-based access or per-use cost associated with it.

Estimate resource usage based on input time:
Application run time can be used to compute the resources used during that time period.<br>
<b>Calculate costs:</b>
Compute resource-based cost: Multiply the estimated compute resource usage (in hours) by their hourly rates provided by the cloud service provider. 
Software licensing fees: If there are any subscription costs associated with accessing the GenAI service or software license fees related to using the AI model (e.g., AzureOpenAI GPT 4), these are added as well. 
For example, if the application uses a monthly subscription fee of $10 per user and used it for 2 hours, then this would contribute an additional cost: ($10/month * 2 hours per day) = 10*2*30 = $ 600

<b>Required Arguments:</b>
the run time of the application

<b>Calculation:</b> 
This metric is calculated as follows:

Cost of application = Compute Resources + Infrastructure cost + Software Licensing Fees

Output is the cost of the application in dollars 

<b>Example code:</b>
# Function to measure cost given inputs from the application.
      </div>
<!-- Accuracy -->
      <div id="matrQA_exact">
        <h2 class="pageTitle">Accuracy</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrQA_exact')">Exact Match</button>
          <button class="button button2" onClick="clickCalled('matrQA_rouge')">ROUGE Score</button>
          <button class="button button2" onClick="clickCalled('matrQA_factual')">Factual Accuracy</button>
        </div>
(This is a Reference Based Evaluator)

The Exact Match metric measures how often the generated response (ex: an answer or a summary) exactly matches the reference (or ground truth answer). Exact match is the proportion of the predicted output that matches the reference.

<b>Details:</b> 
Exact match compares each generated response with the corresponding reference answer. If the generated response exactly matches the reference answer (word-for-word), it is considered a perfect match. 
 
<b>Required Arguments: (your dataset must contain these fields)</b>
<u>application response :</u> the answer / summary given by the application in response to the user query. 
<u>reference:</u> the ground truth answer for the user query.

<b>Calculation (include input, calculation/ formula, output details)</b>
	• Exact Match = Number of overlapping unigrams/ Number of unigrams in the reference.
	• The comparison is based on the exact sequence of unigrams (individual words) between the system-generated summary and the reference summary. Each comparison is scored as 1 if there is an exact match and 0 if there isn't.
	
<b>Output: </b>
	 A number between 0 and 1. 

How to use it?
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
 
response = """The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."""

reference = """Gross Description Received in formalin and labeled hernia sac is a grossly identifiable encapsulated fragment of yellow fibroadipose tissue that measures 4.5 x 1.5 x 0.6 cm in widest dimensions. The specimen is cross sectioned which reveals a surface that is homogeneously balanced and encapsulated with a thin tan-brown membranous
material"""

eval_score = eval_obj.evaluate(response=response,reference=reference,metric="Exact Match")
print(eval_score)


<b>Limitations:</b>
	• It is a strict metric, meaning any minor difference (ex: punctuation, capitalization) will result in a score of 0.
	• Does not account for semantic similarity, it may not capture correct answers that are phased differently.

<b>Source:</b> <a href="https://huggingface.co/spaces/evaluate-metric/exact_match" target="_blank">Exact Match - a Hugging Face Space by evaluate-metric</a>

      </div>

      <div id="matrQA_rouge">
        <h2 class="pageTitle">Accuracy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_exact')">Exact Match</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_rouge')">ROUGE Score</button>
          <button class="button button2" onClick="clickCalled('matrQA_factual')">Factual Accuracy</button>
        </div>
(This is a Reference Based Evaluator) 

(ROUGE-L is currently implemented in the QT package)

ROUGE score measures the overlap of words or phrases (n-grams) between the generated answer and reference answer.

<b>Details:</b> 
Recall-Oriented Understudy for Gisting Evaluation. It is used to assess the quality of automatic summarization systems. These are a set of metrics that compare the application generated answer/ summary with the reference answer/ summary. ROUGE is case insensitive. 
This score is used to check how much of the generated answer/ summary overlaps with the reference. 

<b>Types of Rouge score: </b>
• ROUGE-1 : unigram (1-gram) based scoring, I.e. measures that overlap of individual words. 
• ROUGE-2 : specifically evaluates the overlap of bigrams between the system-generated output and reference summaries, I.e. measures the overlap of pairs of words. 
• ROUGE-L : Longest common subsequence based scoring, I.e. measures the longest sequence of matching words. Ignores newlines and computes LSC for the entire text. 
• ROUGELsum: splits text using "\n". This is a variant of the ROUGE-L metric. This metric applies ROUGE-L to each sentence in the generated answer/ summary and aggregates these scores by computing an average score for all sentences. Suitable for extractive summarization tasks. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<u>application response :</u> the answer / summary given by the application in response to the user query. 
<u>reference:</u> the ground truth answer for the user query.

<b>Calculation:</b>
• ROUGE-L calculates the longest common subsequence by ignoring newlines. 
• Compares the text in the generated answer/ summary with the reference. 

<b>Output: </b>
Output is a score between 0 to 1, where 0 indicates no overlap between bigrams and 1 indicates a perfect match.

<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()

response = """The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."""

reference = """Gross Description Received in formalin and labeled hernia sac is a grossly identifiable encapsulated fragment of yellow fibroadipose tissue that measures 4.5 x 1.5 x 0.6 cm in widest dimensions. The specimen is cross sectioned which reveals a surface that is homogeneously balanced and encapsulated with a thin tan-brown membranous material"""

eval_score = eval_obj.evaluate(response=response,reference=reference,metric="RougeL")

print(eval_score)


<b>Limitations:</b>
• ROUGE score doesn't capture semantic meaning.
• May not handle paraphrasing or synonym usage well. 

<b>Source:</b>
• <a href="https://huggingface.co/spaces/evaluate-metric/rouge" target="_blank">ROUGE - a Hugging Face Space by evaluate-metric</a>
• <a href="https://dev.to/aws-builders/mastering-rouge-matrix-your-guide-to-large-language-model-evaluation-for-summarization-with-examples-jjg" target="_blank">Mastering ROUGE Matrix</a>
        
      </div>

      <div id="matrQA_factual">
        <h2 class="pageTitle">Accuracy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_exact')">Exact Match</button>
          <button class="button button2" onClick="clickCalled('matrQA_rouge')">ROUGE Score</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_factual')">Factual Accuracy</button>
        </div>
(This is an LLM Based Evaluator)

Checks whether the response generated is factually correct and grounded by the provided context.

<b>Details: </b>
This metric measures the degree to which a claim made in the response is true according to the context provided. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<u>question:</u>  the query input to the application by user
<u>context:</u> the information/ text retrieved and input to LLM to answer the question
<u>response:</u> the response given by the model.

<b>Calculation:</b>
• Split the response to facts. The response is divided into different arguments, each stating a fact. Each argument is evaluated on whether it is correct on the basis of supporting context and scores. 
• Rate individual facts on correctness based on the following categories:
○ Completely right (score = 1)
○ Completely wrong (score = 0)
○ Ambiguous (score = 0.5)
• Final score is generated by calculating the mean of the scores of the individual facts.

<b>Output: </b>
A score between 0 and 1. 

<b>Algorithm Elaborated:</b>
<img src="images/matrQAfactual.png"> <br>
<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric() 
query="What is the size of hernia sac"

response = "The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."

context = """Gross Description Received in
formalin and labeled hernia sac is a grossly identifiable encapsulated fragment of yellow fibroadipose tissue that measures 4.5 x 1.5 x 0.6 cm in widest
dimensions. The specimen is cross sectioned which reveals a surface that is homogeneously balanced and encapsulated with a thin tan-brown membranous
material"""

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metric="Factual Accuracy")
print(eval_score)

<b>Sources:</b>
• <a href="https://docs.uptrain.ai/predefined-evaluations/context-awareness/factual-accuracy" target="_blank">Factual Accuracy - UpTrain</a>
• <a href="https://github.com/uptrain-ai/uptrain/blob/main/examples/checks/context_awareness/factual_accuracy.ipynb" target="_blank">Factual Accuracy - Github</a>        
      </div>
<!-- Relevancy -->
      <div id="matrQA_complete">
        <h2 class="pageTitle">Relevancy</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrQA_complete')">Response Completeness</button>
          <button class="button button2" onClick="clickCalled('matrQA_response')">Response Relevance</button>
          <button class="button button2" onClick="clickCalled('matrQA_text')">Text Relevance</button>
          <button class="button button2" onClick="clickCalled('matrQA_answer')">Answer Relevancy</button>
        </div>
(This is an LLM Based Evaluator)

Grades whether the response has answered all the aspects of the question specified.

<b>Details:</b> 
This score measures if the generated response has adequately answered all aspects to the user query asked. This ensures that the model is not generating incomplete responses. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>question:</b>  the query input to the application by user
<b>response:</b> the response given by the model.

<b>Calculation:</b>
• Response completeness is calculated by determining which of the three cases apply to data. 
  ○ The generated answer does not answer the question, 
  ○ partially answers or 
  ○ adequately answers the given question. 
• If no aspect is answered, score is 0, if some are answered, score is 0.5, if all aspects of question are answered, score is 1.

<b>Output: </b>
Response is a score = 0, 0.5 or 1 for each query. A higher response completeness score indicates that the response has answered all aspects of the user's questions. 

<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()

query="What is the size of hernia sac"

response = "The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metrics="Response Completeness")
print(eval_score)


<b>Sources:</b>
• <a href="https://docs.uptrain.ai/predefined-evaluations/response-quality/response-completeness" target="_blank">Completeness - UpTrain</a>
• <a href="https://github.com/uptrain-ai/uptrain/blob/main/examples/checks/response_quality/completeness.ipynb" target="_blank">uptrain-ai/uptrain (github.com) </a>

      </div>

      <div id="matrQA_response">
        <h2 class="pageTitle">Relevancy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_complete')">Response Completeness</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_response')">Response Relevance</button>
          <button class="button button2" onClick="clickCalled('matrQA_text')">Text Relevance</button>
          <button class="button button2" onClick="clickCalled('matrQA_answer')">Answer Relevancy</button>
        </div>
(This is an LLM Based Evaluator)

Measures how relevant the generated response is to the question specified. It is a measure of how well the response addresses the question asked and if it contains any additional information irrelevant to the question asked. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>question:</b>  the query input to the application by user
<b>response:</b> the response given by the model.

<b>Calculation:</b>
• The response is checked for additional irrelevant information, for staying focused on the question, and answering all aspects of the user question. Response is checked for its relevancy to the question.
• The LLM evaluates the response and scores it w.r.t different aspects of the user query being answered, and presence of irrelevant information.

<b>Output: </b>
A score between 0 and 1. A higher response relevance score reflects that the generated response is relevant to the question asked. 

<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()

query="What is the size of hernia sac"

response = "The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."

context = """Gross Description Received in formalin and labeled hernia sac is a grossly identifiable encapsulated fragment of yellow fibroadipose tissue that measures 4.5 x 1.5 x 0.6 cm in widest dimensions. The specimen is cross sectioned which reveals a surface that is homogeneously balanced and encapsulated with a thin tan-brown membranous material"""

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metrics="Response Relevance")
print(eval_score)

<b>Sources:</b>
• <a href="https://docs.uptrain.ai/predefined-evaluations/response-quality/response-relevance" target="_blank">Response Relevance - UpTrain</a>
• <a href="https://github.com/uptrain-ai/uptrain/blob/main/examples/checks/response_quality/relevance.ipynb" target="_blank">uptrain-ai/uptrain (github.com)</a>  
      </div>

      <div id="matrQA_text">
        <h2 class="pageTitle">Relevancy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_complete')">Response Completeness</button>
          <button class="button button2" onClick="clickCalled('matrQA_response')">Response Relevance</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_text')">Text Relevance</button>
          <button class="button button2" onClick="clickCalled('matrQA_answer')">Answer Relevancy</button>
        </div>
This metric has not been implemented in QT package due to dependency issues.

<b>Definition:</b> Evaluates relevance between prompts and responses by computing similarity scores between embeddings generated from prompts and responses.

<b>Details:</b> An objective measure of the similarity between different texts. It serves multiple use cases, including assessing the quality and appropriateness of LLM outputs.

<b>Library:</b>  Langkit

<b>Calculation:</b> Similarity score (cosine similarity) computed using the input_output module in langkit. 

<b>Inputs:</b> Input question and Application response

<b>Output:</b> The similarity score is computed by calculating the cosine similarity between embeddings generated from both prompt and response.
The embeddings are generated using the hugginface's model sentence-transformers/all-MiniLM-L6-v2.

Example:
        
      </div>

      <div id="matrQA_answer">
        <h2 class="pageTitle">Relevancy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_complete')">Response Completeness</button>
          <button class="button button2" onClick="clickCalled('matrQA_response')">Response Relevance</button>
          <button class="button button2" onClick="clickCalled('matrQA_text')">Text Relevance</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_answer')">Answer Relevancy</button>
        </div>
This metric has not been implemented in QT package.

(This is an LLM Based Evaluator)

Evaluates how relevant the actual output of the application is compared to provided input.

<b>Details: </b>
The answer relevancy metric measures the quality of the RAG pipeline's generator by evaluating how relevant the actual output of your LLM application is compared to the provided input/ user query.

<b>Required Arguments:</b> (your dataset must contain these fields)
input/ user query:  the query input to the application by user
response: the response given by the model.

<b>Calculation:</b>
• Answer Relevancy = Number of Relevant Statements / Total Number of Statements
• The Answer Relevancy metric uses an LLM to extract all statements made in the LLM application response. 
• Then, the same LLM is used to classify whether each statement is relevant to the user query.

<b>Output: </b>
A higher answer relevancy score indicates that the response is relevant to the user's question.

<b>How to use it?</b>
add code here

<b>Sources:</b>
• <a href="https://docs.confident-ai.com/docs/metrics-answer-relevancy" target="_blank">Answer Relevancy | DeepEval</a>
• <a href="https://docs.confident-ai.com/docs/guides-rag-evaluation" target="_blank">RAG Evaluation | DeepEval</a>
      </div>
<!-- Hallucination -->
      <div id="matrQA_hallucination">
        <h2 class="pageTitle">Hallucination</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrQA_hallucination')">Hallucination Degree</button>
          <button class="button button2" onClick="clickCalled('matrQA_validity')">Context Validity</button>
          <button class="button button2" onClick="clickCalled('matrQA_disregard')">Context Disregard</button>
        </div>
(This is an LLM Based Evaluator)

Grades how concise the generated response is or if it has any additional irrelevant information for the question asked.

<b>Details: </b>
This score measures whether the generated response contains any additional information irrelevant for the question asked. Response conciseness refers to the quality of a generated response in terms of being clear, brief, and to the point. A concise response effectively conveys the necessary information without unnecessary elaboration or verbosity. It focuses on addressing the core of the question or query in a straightforward manner.

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>question:</b>  the query asked by user
<b>response:</b> the response given by the application

<b>Calculation:</b>
  • Response conciseness is calculated by determining which of the three cases apply for given task data:
    ○ The generated answer has a lot of additional irrelevant information
    ○ The generated answer has little additional irrelevant information, or 
    ○ The generated answer has no additional irrelevant information. 
  • Hallucination Degree = 1- Response Conciseness

<b>Output: </b>
  • Hallucination Degree equal to 0 indicates zero hallucination in the application response, that is, the application response has no additional irrelevant information. 
  • Hallucination Degree equal to 1 indicates that there is low response conciseness, that is, the application response has lot of additional irrelevant information. 

<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()

Query = "In the case of John Brown, who underwent surgery for a recurrent right inguinal hernia, what were the findings in the pathology report regarding the soft tissue in the inguinal region?"

response = "The pathology report found that the soft tissue in the inguinal region contained a hernia sac containing hemorrhage and areas of fibrosis, but was negative for malignancy"

context = """inguinal hernia. Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician 1 Adm Date: 11/12/1999 DOB: 09/10/44 - 
POSTOPERATIVE DIAGNOSIS: Recurrent right inguinal hernia. PROCEDURE PERFORMED: Repair of recurrent right inguinal hernia, resection of lipoma of the | GENITALIA: Normal male. RECTAL: Negative. Prostate 1+. EXTREMITIES: Symmetric. IMPRESSION: 1. Right inguinal hernia recurrent. Community General
Hospital Anytown, USA HISTORY AND PHYSICAL Page 2 of 2 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. - Consulting | material. No ulceration, pigmentation or nodular abnormalities can be grossly identified. Representative portions submitted in one cassette. Diagnosis Soft tissue
inguinal region: Hernia sac containing hemorrhage and areas of fibrosis, negative for malignancy. Sally Johnson, M.D. Pathologist Dally Johnson Name: - 0.0.Bi | INDICATIONS FOR ADMISSION: Mr. Brown is a 54-year-old white male who presented with pain to Dr. Jeff Moore. He had a hernia repair, on the right, in the
past, and this was recurrent. He was scheduled for surgery. HOSPITAL COURSE: The patient was admitted on 11/12/1999 and underwent surgery, and did fine. | discomfort. He is admitted for repair of a right inguinal hernia. PAST MEDICAL HISTORY: Denies. MEDICATIONS: None. PAST SURGICAL HISTORY: Hernia
surgery on the right in the past. The patient also has had a left inguinal hernia repair in the past. EXAMINATION VITAL SIGNS: Blood pressure 140/90. | INGUINAL HERNIA Specimen Submitted HERNIA SAC Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician 1
Adm Date: 11/12/1999 DOB: 09/10/44 Ordering Physician: Jeff T. Moore Pathologist: Sally Johnson, M.D. Location: 3W 0328 P Gross Description Received in | of 2 REASON FOR ADMISSION: This is a 54 year old male, admitted here for repair of right inguinal hernia. HISTORY OF PRESENT ILLNESS: The patient has
had his hernia repaired in the past, elsewhere. Over the past number of months, he has seen this hernia come back and recur, and become larger. It causes | Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 DISCHARGE SUMMARY Page 1 of 1 ADMITTING DIAGNOSIS: 1.
Recurrent right inguinal hernia. 1. DISCHARGE DIAGNOSIS: Same. PROCEDURES PERFORMED: 1. Repair of recurrent right inguinal hernia. HISTORY AND"""

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metric="Hallucination Degree")

print(eval_score)

<b>Sources:</b>
• <a href="https://docs.uptrain.ai/predefined-evaluations/response-quality/response-conciseness" target="_blank">Response Conciseness - UpTrain</a>
• <a href="https://github.com/uptrain-ai/uptrain/blob/main/examples/checks/response_quality/conciseness.ipynb" target="_blank">uptrain-ai/uptrain (github.com)</a>
• <a href="https://blog.uptrain.ai/revealing-the-hidden-truths-the-negative-impacts-of-hallucinations-in-large-language-models-llms/" target="_blank">UpTrain AI</a>
        
      </div>

      <div id="matrQA_validity">
        <h2 class="pageTitle">Hallucination</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_hallucination')">Hallucination Degree</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_validity')">Context Validity</button>
          <button class="button button2" onClick="clickCalled('matrQA_disregard')">Context Disregard</button>
        </div>
(This is an LLM Based Evaluator)

Evaluates how relevant the retrieved context is to the question specified.

<b>Details: </b>
Context relevance score measures if the retrieved context has enough information to answer the question being asked. A bad context reduces the chances of the model giving a relevant response to the question asked, and leads to hallucinations.

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>question</b>  the query asked by user
<b>context:</b> the information/ text retrieved and input to LLM to answer the question

<b>Calculation:</b>
  • Context relevance is evaluated by determining which of the following three cases apply for given inputs:
    ○ The extracted context can answer the given query completely.
    ○ The extracted context can give some relevant answer for the given query, but cannot answer it completely, or 
    ○ The extracted context doesn't contain any information to answer the given query.
  
<b>Output: </b>
  • The metric scores calculated for the examples show that a given task is scored 0, 0.5 or 1, based on the above.
  
<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
  
Query = "Hello, I'm updating a patient's chart and need to administer care. Can you tell me if the patient has any known allergies that I should be aware of?"

response = "Yes, the patient's chart lists allergies under the section "ALLERGIES" and indicates that they have allergies to medications, food, environmental factors, anesthetics, dyes, and rubber/latex/balloons."

context = """have allergies and code status listed on the front of my chart to ensure my safety as a patient. 2. General Risks. The undersigned understands that the practice of
medicine and surgery is not an exact science and that diagnosis and treatment may involve risks of injury or even death. No guarantees can or have been made | Personal Pharmacy Rx OTC
NAME
DOSE/FREQUENCY
TIME OF LAST DOSE
NA
1
Do you use herbs or other alternative medications: 4 Yes O No List: Ginko Occasionally Orientation to room: Call Light IV/telephone bathroom location lights meal 
time visitor policy Personal belongings kept on person or at bedside: None Eye glasses Contacts Hearing aids Glass eye Walker Wheelchair Denture | ALLERGIES Medications Food Environmental Anesthetics Dyes Rubber/latex/balloons: Yes (No N/A Other HABITS Tobacco: Yes No per day Yrs. Chew: Yes No
per day Yrs. Other Alcohol: Yes No per day yrs. Drug use/abuse: Yes No Type MEDICATIONS: Brought to hospital: Y N Sent Home: Y N To Pharmacy: Y N
Personal Pharmacy Rx OTC
NAME
DOSE/FREQUENCY
TIME OF LAST DOSE
NA
1 | Medication
Dose
Frequency
Reason
Last Dose
New Med
Has Rx
Education Sheet
Education/Handouts Given: YES INO MINA YES NO ZNA Special Instructions: Keep clean & dry YES NO NA YES NO BINA YES. NO DANA Primary Diagnosis
Wound Care Daily Weight Smoking cessation Vaccines-information (Influenza, Pneumococcal NUTRITION Special Instructions: Diet Regular O YES INO Meals | 9. GI . 10. Steroid use 11. Flu Vaccine Current Q N 12. Pneumonia Vaccine current Y (N. if no give patient information. PULSE NKA 82 RESP 20 B/P 134/79 Ht.
5'9". Wt 190.9 lbs 1. Diabetes 2. Epilepsy/seizure disorder 3. High Blood Pressure 4. Heart Disease 5. Kidney Disease 6. Cancer VITALS: TEMP 96.7 | Equipment/Supplies (Provider List) YES NO MINA Transportation Arranged Special Instructions: Patient Signature/Date: John Brown Person Giving
Instructions/Date: Jemy Leurs Physician Signature/Date: 1 White Copy - Chart Yellow Copy - Patient DISCHARGE CHECKLIST: O ADMISSION CONSENT | :unselected: :unselected: :selected: :unselected: :unselected: :selected: :unselected: Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore,
M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Community General Hospital Anytown, USA DISCHARGE INSTRUCTION SHEET
Medication
Dose
Frequency
Reason
Last Dose
New Med
Has Rx
Education Sheet | Time
Medications Type, Route, Amt., Site
Allergies: NKDA Nurses Notes Warming Blanket O :unselected:
0920-
LR
SUCC in. IV site F Redness Jedema po (R) Feno
POST ANESTHESIA
RECOVERY SCORE
ON ARRIV.
15 MIN.
30 MIN.
45 MIN.
60 MIN.
DIS- CHG
Able to move 4
extremeties voluntarily
or on command = 2
Able to move 2
extremeties voluntarily
or on command = 1
Able to move 0
extremeties voluntarily"""

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metric="Context Validity")
print(eval_score)


<b>Sources:</b>
  • <a href="https://docs.uptrain.ai/predefined-evaluations/context-awareness/context-relevance" target="_blank">Context Relevance - UpTrain</a>
  • <a href="https://blog.uptrain.ai/a-comprehensive-guide-to-context-retrieval-in-llms-2/" target="_blank">A Comprehensive Guide to Context Retrieval in LLMs - UpTrain AI</a>
  • <a href="https://github.com/uptrain-ai/uptrain/blob/main/examples/checks/context_awareness/relevance.ipynb" target="_blank">uptrain-ai/uptrain (github.com)</a> 
      </div>

      <div id="matrQA_disregard">
        <h2 class="pageTitle">Hallucination</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_hallucination')">Hallucination Degree</button>
          <button class="button button2" onClick="clickCalled('matrQA_validity')">Context Validity</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_disregard')">Context Disregard</button>
        </div>
This metric has not been implemented in QT package.

(This is an LLM Based Evaluator)

Measures how complete the generated response is for the question specified, given the information provided in the context.

<b>Details:</b> Context Disregard score measures if the generated response has insufficiently used the retrieved context to answer the question being asked. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>question:</b>  the query asked by user
<b>context:</b> the information/ text retrieved and input to LLM to answer the question
<b>response:</b> the response given by the model

<b>Calculation:</b>
  • Context disregard is evaluated by determining which of the following three cases apply for given inputs:
    ○ The generated response doesn't incorporate any information present in the context. 
    ○ The generated response incorporates some of the information present in the context, but misses some of the information in context which is relevant for answering the given question.
    ○ The generated response incorporates all the relevant information present in the context.  
  • Context disregard = 1- context utilization.
  • Context disregard, when 0 indicates that response incorporates all the relevant information present in the context to answer the user question. This indicates hallucination is 0. 
  • Context disregard, when 1, indicates that the response does not incorporate any information present in the context to answer the user query. This indicates hallucination is 1. 
  
<b>Output: </b>
A values between 0 and 1.
  
<b>How to use it?</b>
add code here

<b>Sources:</b>
  • <a href="https://docs.uptrain.ai/predefined-evaluations/context-awareness/context-utilization" target="_blank">Context Utilization - UpTrain</a>
  • <a href="https://github.com/uptrain-ai/uptrain/blob/main/examples/checks/context_awareness/context_utlization.ipynb" target="_blank">uptrain-ai/uptrain (github.com)</a>
      </div>
<!-- Robustness -->
      <div id="matrQA_syntax">
        <h2 class="pageTitle">Robustness</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrQA_syntax')">Syntax Sensitivity</button>
          <button class="button button2" onClick="clickCalled('matrQA_lang')">Language Critique</button>
          <button class="button button2" onClick="clickCalled('matrQA_aspect')">Aspect Critique</button>
        </div>
This metric has not been implemented in QT package due to dependency issues.

<b>Definition:</b> This class of metrics assesses the NLP model's ability to handle input text that includes abbreviations and other changes to language. 

<b>Details:</b> Metrics from the HELM library for robustness such as F1 score and exact match under perturbations. Also there are at least 10 metrics from  langtest to evaluate different aspects of language in a model string distance, case sensitivity and syntax sensitivity can be used. 

<b>Library:</b> Langtest HELM

<b>Calculation:</b> These metrics measure how the model performs with changes in the case, abbreviations in the input text. The goal is to understand how documents with typos or fully uppercased sentences affect the model's prediction performance compared to documents similar to those in the original training set.

<b>Inputs:</b> Input text, Expected result

<b>Output:</b> Score between 0 and 1.        
      </div>

      <div id="matrQA_lang">
        <h2 class="pageTitle">Robustness</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_syntax')">Syntax Sensitivity</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_lang')">Language Critique</button>
          <button class="button button2" onClick="clickCalled('matrQA_aspect')">Aspect Critique</button>
        </div>
(This is an LLM Based Evaluator)

The Language Critique metric scores machine generated response on multiple aspects : fluency, politeness, grammar, and coherence.

<b>Details:</b> 
  It involves analyzing how well the language used in a response conveys the intended message, whether it addresses the question or issue comprehensively, and if it is free from ambiguity or confusion.
  • Grades the quality and effectiveness of language in a response, focusing on factors such as clarity, coherence, conciseness, and overall communication. 
  • Language Evaluation helps analyse how well the language used in a response conveys the intended message, whether it addresses the question completely and if it is free from ambiguity or confusion. 
  
<b>Required Arguments: (your dataset must contain these fields)</b>
<b>response:</b> the response given by the application

<b>Calculation:</b>
  • Considers features such as fluent, polite, grammatically correct and coherent, and determine one of the following three cases for evaluation:
    ○ The response is highly rated on these features.
    ○ The response is moderately rated on these features.
    ○ The response is poorly rated on these features. 
    
<b>Output: </b>
  • Scores between 0 to 1 are given to each response on fluency, grammar, politeness and coherence. 
  •  The mean is the overall score for language critique
  
<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
  
response = "Yes, the patient's chart lists allergies under the section "ALLERGIES" and indicates that they have allergies to medications, food, environmental factors, anesthetics, dyes, and rubber/latex/balloons."

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metric="Language Critique")

print(eval_score)

<b>Source:</b>
  • <a href="https://docs.uptrain.ai/predefined-evaluations/language-quality/fluency-and-coherence" target="_blank">Language Features - UpTrain</a>
  • <a href="https://github.com/uptrain-ai/uptrain/blob/main/examples/checks/language_features/language_critique.ipynb" target="_blank">uptrain-ai/uptrain (github.com)</a>
        
      </div>

      <div id="matrQA_aspect">
        <h2 class="pageTitle">Robustness</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_syntax')">Syntax Sensitivity</button>
          <button class="button button2" onClick="clickCalled('matrQA_lang')">Language Critique</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_aspect')">Aspect Critique</button>
        </div>
This metric has not been implemented in QT package due to dependency issues.

(This is an LLM Based Evaluator)

This metric is designed to assess submissions based on predefined aspects such as harmlessness and correctness.

<b>Details: </b>
Users have the flexibility to define their own aspects for evaluating submissions according to their specific criteria. The output of aspect critiques is binary, indicating whether the submission aligns with the defined aspect or not. This evaluation is performed using the 'answer' as input.

<b>Required Arguments:</b> (your dataset must contain these fields)
response: the response given by the application

<b>Calculation:</b>
    ○ Critiques within the LLM evaluators evaluate submissions based on the provided aspect. 
    ○ Predefined aspects are: harmfulness, maliciousness, coherence, correctness, conciseness.
    
<b>Output: </b>
  • A score between 0 to 1
  
<b>How to use it?</b>
add code here 

<b>Source:</b>
  • <a href="https://docs.ragas.io/en/v0.1.0/concepts/metrics/critique.html" target="_blank">Aspect Critique | Ragas</a>
      </div>
<!-- Efficiency -->
      <div id="matrQA_Latency">
        <h2 class="pageTitle">Efficiency</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrQA_Latency')">Latency</button>
          <button class="button button2" onClick="clickCalled('matrQA_cost')">Cost</button>
        </div>
Logs the time taken for a GenAI application to generate a response from the moment it receives an input 
until the output is provided.

Helps assess the responsiveness and real-time performance of the application. This is an important aspect of GenAI applications that generate content in real-time. Latency allows the user to track a GenAI application and compare it with other applications or models. It captures the model's performance and responsiveness under different loads/ scenarios. 

<b>Required Arguments:</b>
the start time from the application and end time from the application to process a user query

<b>Calculation: </b>
    Latency = Time at output – Time at Input

Output is the time in Milliseconds (ms)/ Seconds (s).

<b>Example code:</b> (change the code)

Latency can be passed as an argument to log response specific metric for an application. To calculate latency, you can refer below example, 

# Function to measure latency for a single request 
def measure_latency(input_text): 
start_time = 
end_time = 
latency = end_time – start_time 

print(latency)

To log latency into Q&T, use the below code

from app.qualitytrust.suite.log_metrics import LogMetrics

log_metrics = LogMetrics()

log_metrics.log_response_metrics(app_name="Prior Authorization", model_name="GPT Turbo 3.5",task="Q & A",session_id="123REQt1",case_id='E101',response = response ,context = context ,question = query,latency=10,cost=0.8)


<b>Note - </b>
  • Latency cannot be calculated in Q&T solution package. We can only log latency of LLM call completion in Q&T solution database.
  • Make sure database and configuration setup is done before.  
      </div>

      <div id="matrQA_cost">
        <h2 class="pageTitle">Efficiency</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_Latency')">Latency</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_cost')">Cost</button>
        </div>
Measures the total for a GenAI application to generate a response from the moment it receives an input until the output is provided. This also includes the cost of evaluation of the response. 

<b>Required Arguments:</b>
number of tokens for response, token cost

<b>Calculation: </b>
This metric is calculated in the backend. Consider calculating the number of tokens for a response. Can be calculated using call back function. 

<b>Cost of LLM inference</b> = (Number of input tokens * Rate of LLM for inputs) + (Number of out tokens * Rate of LLM for output)

<b>Output</b> is the cost of the application in dollars 

After calculation, to log calculated LLM cost in Q&T, see the example below:

<b>How to use it?</b>
from app.qualitytrust.suite.log_metrics import LogMetrics

log_metrics = LogMetrics()

log_metrics.log_response_metrics(app_name="Prior Authorization", model_name="GPT Turbo 3.5",task="Q & A",session_id="123REQt1",case_id='E101',response = response ,context = context ,question = query,latency=10,cost=0.8)        
      </div>
<!-- Bias -->
      <div id="matrQA_gender">
        <h2 class="pageTitle">Bias</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrQA_gender')">Gender and Racial Bias</button>
          <button class="button button2" onClick="clickCalled('matrQA_honest')">Honest Score</button>
        </div>
(This is an LLM Based Evaluator)

This metric determines whether there is gender or racial bias in the GenAI application / LLM response. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>input:</b> The user query that is input to the application. 
<b>response:</b> The actual output generated by the GenAI application/ LLM.

<b>Calculation :</b>

The BiasMetric is calculated according to the following equation: 

      Bias = Number of biased opinions
                              Total number of opinions
  
Step 1: Use an LLM to list all the opinions found in the response.
Step 2: Use an LLM to classify each opinion as biased or not.

<b>Definition of Bias :</b>
  • <b>Gender Bias:</b> Discrimination based on a person's gender. 
  • <b>Racial/ Ethnic Bias:</b> or discrimination based on a person's race, ethnicity or national origin. 
  • <b>Geographical Bias:</b> Prejudice or preferential treatment based on where a person lives or comes from. 
<b>Definition of Opinion:</b>
  • Opinions are personal beliefs or judgements, not verifiable facts. 
  • A mistaken statement
  • Citation of a source, a reported statement, not a subjective opinion.

<b>How to use this?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
  
query = "Could you please confirm Ms. Jane Doe's name and date of birth as they appear on the Certificate of Medical Necessity for her continuous glucose monitoring supplies?"

response = "Ms. Jane Doe's name and date of birth on the Certificate of Medical Necessity for her continuous glucose monitoring supplies are as follows: Patient Name: Ms. Jane Doe Date of Birth: 05/10/1967"

eval_score = eval_obj.evaluate(query=query,response=response,metrics="Gender and Racial Bias")

print(eval_score)


<b>Source: </b>
<a href="https://docs.confident-ai.com/docs/metrics-bias" target="_blank">Bias | DeepEval</a>    
      </div>

      <div id="matrQA_honest">
        <h2 class="pageTitle">Bias</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_gender')">Gender and Racial Bias</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_honest')">Honest Score</button>
        </div>
(This is a rule based Evaluator)

The Honest score aims to measure hurtful sentence completions in language models.

<b>Details: </b>
Uses HurtLex, a multilingual lexicon of hurtful language to evaluate the completions. Aim 
is to quantify how many times a sentence is completed with a hurtful word and if there is any difference between groups such as genders. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>response:</b> The actual output generated by the GenAI application/ LLM.

<b>Calculation: </b>
  • Relies on a pre-built dictionary (HurtLex) to measure the hurtful nature of completions
  • The metric matches the words generated by the LLM / response against the HurtLex lexicon to quantify the instances of hurtful completions.
  • The metric assesses if there is a bias by comparing the frequency of hurtful completions across different groups (e.g., genders, sexual orientations).

<b>Output: </b>
A score between 0 and 1. 

<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
  
response = "The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metric="Honest Score")

print(eval_score)

<b>Source:</b>
  • <a href="https://huggingface.co/spaces/evaluate-measurement/honest" target="_blank">Honest - a Hugging Face Space by evaluate-measurement </a>
  • <a href="https://aclanthology.org/2021.naacl-main.191.pdf" target="_blank">HONEST: Measuring Hurtful Sentence Completion in Language Models (aclanthology.org)</a>
        
      </div>
<!-- Toxicity -->
      <div id="matrQA_toxic">
        <h2 class="pageTitle">Toxicity</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrQA_toxic')">Toxic Opinions</button>
          <button class="button button2" onClick="clickCalled('matrQA_abuse')">Abusive Speech</button>
        </div>
(This is an LLM Based Evaluator)

This metric determines whether there is toxicity in the GenAI application / LLM response. Toxicity in the application response includes personal attack, mockery, threats or intimidation. 

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>input:</b> The user query that is input to the application. 
<b>response:</b> The actual output generated by the GenAI application/ LLM.

<b>Calculation :</b>

The ToxicityMetric is calculated according to the following equation: 

    Toxicity = Number of toxic opinions
                            Total number of opinions
  
Step 1: Use an LLM all the opinions found in the response.
Step 2: Use an LLM to classify each opinion as toxic or not.

<b>Definition of Toxic Opinion:</b>
  • Personal Attacks: Insults or hostile comments aimed at degrading the individual rather than addressing their ideas.
  • Mockery: Sarcasm or ridicule used to belittle someone.
  • Hate: Expressions of intense dislike or disgust, often targeting someone's identity or beliefs.
  • Dismissive Statements: Comments that invalidate the person's viewpoint or shut down discussion without engaging constructively.
  • Threats or Intimidation: Statements intending to frighten, control, or harm someone, either physically or emotionally.
  
<b>Output: </b>
  The percentage of toxic opinions in the response. A number between 0 and 1. 

<b>Example: </b>

#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric()
  
query="What are the limitations that substantially affect Ms. Jane Doe's daily life due to her diabetes complications?"

response = "Ms. Jane Doe's diabetes complications, such as neuropathy or retinopathy, may cause nerve damage/vision loss/other limitations and substantially limit her ability to walk/see/care for herself/perform other life activities."

eval_score = eval_obj.evaluate(query=query,response=response,metrics="Toxic Opinions")


print(eval_score)

<b>Source: </b>
<a href="https://docs.confident-ai.com/docs/metrics-toxicity" target="_blank">Toxicity | DeepEval - The Open-Source LLM Evaluation Framework (confident-ai.com)</a>
        
      </div>

      <div id="matrQA_abuse">
        <h2 class="pageTitle">Toxicity</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrQA_toxic')">Toxic Opinions</button>
          <button class="button button2 active" onClick="clickCalled('matrQA_abuse')">Abusive Speech</button>
        </div>
(This is an LLM based evaluator)

The toxicity measurement aims to quantify the toxicity of the input texts using a pretrained hate speech classification model. The default model used is roberta-hate-speech-dynabench-r4. In this model, ‘hate’ is defined as “abusive speech targeting specific group characteristics, such as ethnic origin, religion, gender, or sexual orientation.” 

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>Input Text:</b> The actual output generated by the GenAI application/ LLM. Is a collection of sentences.

<b>Calculation: </b>
Returns the maximum toxicity value computed for the sentences in the input text. We can also choose to compute the ratio of toxic sentences in the input text. 

<b>Output:</b>
Is a list of toxicity scores, one for each sentence in 'input text'. 
or
Returns the maximum toxicity over all the scores on the input text. 
or
Returns the percentage of predictions with toxicity score >= 0.5

<b>Example:</b> Also does this metric need context and query? The metric definition does not specify!

from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
  
response = "The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."

eval_score = eval_obj.evaluate(query=query,response=response,context=context,metric="Abusive Speech")

print(eval_score)

<b>Source:</b>
<a href="https://github.com/huggingface/evaluate/tree/main/measurements/toxicity" target="_blank">evaluate/measurements/toxicity at main · huggingface/evaluate (github.com)</a>
        
        
      </div>

      <div id="matrSum_agreement">
        <h2 class="pageTitle">Accuracy</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrSum_agreement')">Agreement Score</button>
          <button class="button button2" onClick="clickCalled('matrSum_coverage')">Coverage Score</button>
          <button class="button button2" onClick="clickCalled('matrSum_summa')">SummaCConv</button>
        </div>
(This is an LLM Based Evaluator)

Agreement score metric compares information in a summary and the source document and gives a score for agreement between the summary and the source document.  

This evaluator compares information between a source document and an LLM generated summary. The evaluator then generates close ended questions from the summary. It compares the answers from the summary and the document. Agreement Score is the percentage of questions that had identical answers for both summary and document.

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>document:</b> The source document that contains the information that should be summarized.
<b>response/ summary:</b> The LLM generated summary of the source document.
  
<b>Calculation (include input, calculation/ formula, output details)</b>

  The evaluator compares the information between a source document and an LLM generated summary.
  
  Step 1: Generates N closed-ended (Y/N/Unknown) questions from the summary information.
  Step 2: QuestionAnswerer LLM is used to answer each question given ONLY the summary as context.
  Step 3: QuestionAnswerer LLM is used to answer each question given ONLY the source document as context.
  Step 4: Compare the answers from the summary and document for each question to find contradictions.

<b>Output: </b>
  The percentage of questions that had identical answers for both contexts. A number between 0 and 1. 
  
<b>Algorithm Elaborated</b>

<img src="images/matrSum_agreement.png">

<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
  
context = "4-part set) or Order Form 1266/5 (if 5-part set) PHYSICIAN'S ORDERS NAME Name: John Brown ROOM NO. Account No: 12345 (ADDRESS) Attending
Physician: Jeff T. Moore, M.D. Consulting Physician HOSP. NO.
DIET
AGE
WEIGHT
SEX
  
DIAGNOSIS PHYSICIAN Adm Date: 11/12/1999 DOB: 09/10/44 DRUG ALLERGIES
Date & Time
DO NOT USE THIS
SHEET" UNLESS A RED NUMBER SHOWS
11/11 199
ONPO Right Ing
Q. CBC + urine PATIENT NAME
BED NO
Brown, John
238B
Kale Ravis AV (Kd) ( ) ( ) ( ) ) ( ) Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D.
Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Graphics Flowsheet 1
DATE: 11 Admit 1
TEMPERATURE
104
:unselected:
:unselected: Page 2 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 D =
Data A = Action R = Response
SHIFT INIT
NURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE
13fc
L. Carradine
heura repair RLQ - Abd Sort c
banned Sounds - Dsy dy - Voiding knowledge. Attending Physician Date :selected: :unselected: :unselected: :unselected: :unselected: :unselected: :unselected: :unselected: :unselected: HR3
Community General Hospital Anytown, USA CONSENT TO TREATMENT AND CONDITIONS OF ADMISSION Name: John Brown Account No: 12345 Attending you are acknowledging that you have received a copy of our Notice of Privacy Practices. Patient's Name: (please print) John Brown Patient, Parent, Guardian,
Agent: Date: 11.10.99 Time: Witness: Date: Time: 322 If other than patient, indicate relationship: Guarantee of Account by Person other than Patient: I agree to um
0035
fra completed. - : en
0530
Pre-Op
OR called for pre-op Kg
Precip quem as ordered. See MAR. -
KC
0410
To OR via stretcher the chart k.
Form #8002088 (Rev. 1/98) Page 3 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician 24 HOUR 1266/4 (if 4-part set) or Order Form 1266/5 (if 5-part set) PHYSICIAN'S ORDERS NAME Name: John Brown Account No: 12345 ROOM NO (ADDRESS)
Attending Physician: Jeff T. Moore, M.D. Consulting Physician HOSP. NO.
DIET
AGE
WEIGHT
SEX PM
AM
PM
BATHING
ORAL CARE
PERICARE
LOTION RUB
ACTIVIY
REPOSITION
EDGE OF BED
UP IN CY
AMBULANEN
62-6019-27.0602 :unselected: :unselected: :unselected: :unselected: Community General Hospital Anytown, USA Name: John Brown Account No: 12345
Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 PATIENT ADMISSION ASSESSMENT Date 11/11/99 Time :unselected:
Page 2 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 D =
Data A = Action R = Response
SHIFT INIT NURSE SIGNATURE SHIFT INIT NURSE SIGNATURE
93 M Dally Madisc RN TIME FOCUS D, A, R FOCUS NOTES 7400
admission 1266/4 (if 4-part set) or Order Form 1266/5 (if 5-part set) PHYSICIAN'S ORDERS NAME ROOM NO (ADDRESS) HOSP. NO.
DIET
AGE
WEIGHT
SEX
DIAGNOSIS PHYSICIAN 1 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB:
09/10/44 DRUG ALLERGIES
Date & Time
Another brand of drug
Identical in form and content may be dispensed unless FOCUS NOTES
heura repair RLQ - Abd Sort c
banned Sounds - Dsy dy - Voiding
95- Appetito
Am Care quien - OU B.
Amb in hall ) Accepting diet will-t
Requested faim med en RLA ducesonal Portal 10 mg given TO. Will cont monitor Dish Home reyost Pari P.I)
1130
Ja Trop IJames po quia
Howaura
Form #8002088 (Rev. 1/98) Page 3 of 4 :unselected:
Page 2 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 D =
Data A = Action R = Response
SHIFT INIT
NURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE
3D
Kim Danielsen
TamFandomRN
13PC
Diana Camp CON
TIME
FOCUS NURSING CARE FLOW SHEET DATE: 11/12/99 1 1 SPACES LEFT BLANK INDICATE CONDITION NOT APPLICABLE AT THAT TIME
SHIFT INIT
NURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE
750
I Contin RNC
1.78
Tom Sander Rd
Adm Date: 11/12/1999 DOB: 09/10/44 3-" AT andria Shands RN
ASSESSMENT
0020 :unselected: :unselected: :selected: :unselected: :unselected: :selected: :unselected: Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore,
M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Community General Hospital Anytown, USA DISCHARGE INSTRUCTION SHEET
Medication Dose Frequency Reason Last Dose New Med Has Rx Education Sheet NURSE SIGNATURE
93 M
Dally Madisc RN
Rt. admitted for surgery in A. M for RIH
Rt. alent and cliented. Reszeven and
and unloved. VSS Family et bedside
no significant hx. present. Bit hermin repos in post. distress noted. See admission
assessment further information um
0035
A 40 H2 25.0 mm/s |10.0 mm/mV 4 by 2.5s + 1 rhythm ld MAC 8 002B 12SLtm v250 Community General Hospital Anytown, USA RADIOLOGY REPORT Page 1 of
1 Name: John Brown DOB: 09/10/44 Ordering Physician: Jeff T. Moore, M.D. Exam date: 11/10/1999 Radiology Number: 506024 Account Number: 12345 :unselected: :unselected: :selected: :selected: :unselected: :selected: :selected: :selected: Name: John Brown Account No: 12345 Attending Physician: Jeff T.
Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 24 HOUR NURSING CARE FLOW SHEET DATE: 11/11/99 SPACES LEFT BLANK
INDICATE CONDITION NOT APPLICABLE AT THAT TIME
SHIFT INIT NURSE SIGNATURE SHIFT INIT
NURSE SIGNATURE HR1 Sample Inpatient Health Record This record was created for educational purposes only. The information in this sample record, though clinically accurate, is
fictitious. Any resemblance to real people or to any actual clinical case is merely coincidental. AHâ– MA Continuing Education Career-building Resources HR2 on Monday. D: 11/13/1999 T: 11/16/1999 wms cc: Jeff T. Moore, M.D. Tom W. Smith, M.D. Community General Hospital Anytown, USA HISTORY AND
PHYSICAL Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Page 1 hernia. Denies chest complaints/SOB. D: 11/10/1999 T: 11/10/1999 mls Chuck Hamlin, M.D. Radiologist Chuck Hamlin Community General Hospital Anytown,
USA RADIOLOGY REPORT Page 1 of 1 EXAM: Abdomen KUB portable 1 vw HISTORY: Postoperative. Inguinal hernia. Name: John Brown DOB: 09/10/44 0600
count vilaband, AD inpt. status
Form #8002088 (Rev. 1/98) Page 3 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date:
11/12/1999 DOB: 09/10/44 24 HOUR NURSING CARE FLOW SHEET DATE: NOV 1 3 1999 SPACES LEFT BLANK INDICATE CONDITION NOT APPLICABLE
AT THAT TIME SHIFT INIT Insured's Name John Brown Group Name Southern Company
Financial Class
Admitted By
Patient Weight
Discharge Date
Disch. Time
AD12
11/13/99
11:30
Provisional Diagnosis Right Ing Hernia
Principal Diagnosis, Secondary Diagnosis and
Complications
550.91 214.4
Principal Procedures and Secondary Procedures
11-12 Moore
53.03 63.3
49520
Consultations Shift Jeare
SPECIMEN SENT
DIAGNOSTIC TEST OR THERAPY
TIME OUT
TIME II
Form #8002088 (Rev. 1/98) Page 1 of 4 INTRAVENOUS THERAPY FLOW SHEET FLUID DOCUMENTATION KEY:
TIME
AMOUNT
IV SOLUTIONS,
ADDITIVES
RATE
TUBING
PUMP
INITIALS
unselected: Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 1. Consent for Medical and Hospital Care. The undersigned consents
to the following: a. All treatment and procedures to be performed during this hospitalization or on an outpatient basis (including emergency treatment or services). DATE/TIME
NOTES
NAME/TITLE
11/12/99
Dicteoral op Note
2 duass & Marly Mesh
11/13
5 pm
At 5 och
VSS -
De har
Flujo Dr. Moren
62-6018-45-0503 Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting
Physician - 1 Adm Date: 11/12/1999 DOB: 09/10/44 ***** ** GENERAL CHEMISTRY ** *: ************
ATE: IME:
11/10/99 1620 --- can come back ,may May have to be removed I CERTIFY THAT I HAVE READ AND FULLY UNDERSTAND THE ABOVE CONSENT. Physician Signature
Patient/Guardian Signature Date/Time 11.10.99 Relationship to Patient Witness' Printed Name Witness' Signature Orig. 8/02 LM3370-35c 1 ANESTHESIA Community General Hospital INPATIENT REGISTRATION AND SUMMARY FORM Patient Account # 12345 Medical Record # 215043
Patient Name
(Last) (First) (Middle)
Attending Physician Number and
Name
Patient Type
Hospital
Admit Date
Admit time
Brown, John
Jeff T. Moore 97
Inp
Services S
11/12/99
11:10 ADDITIONAL DISCHARGE MEDS
INSTRUCTIONS REFUSED :unselected: :unselected: :unselected: Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Org
506
Service Type
S
Name
BROWN, JOHN
Client ID
123-456-678
Living Arrangements
Home
Reference Auth #
Requesting NPI # 4567891212
Requesting Fax #
Billing NPI # 4567891212
Name Jeff T. Morre
Referring NPI # 4567891213
Referring Fax #
Service Start Date: 11/12/99
Description of service being requested:
15. Right Ing. Hernia
18. Serial/NEA or MEA #
20. Code Qualifier
21. National Code
49520 have allergies and code status listed on the front of my chart to ensure my safety as a patient. 2. General Risks. The undersigned understands that the practice of
medicine and surgery is not an exact science and that diagnosis and treatment may involve risks of injury or even death. No guarantees can or have been made Extra Large Plug REF 01146 REF 01172 :unselected:
:unselected:
LOT 32FDJ2 LOT 32DKM1 :unselected:
62-6018-45-0503 Community General Hospital Anytown, USA OPERATIVE PROGRESS NOTE Name: John Brown Account No: 12345 Attending Physician: Jeff
T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44
DATE/TIME NOTES NAME/TITLE
11/12/99
Surgeon: Mare DIAGNOSIS PHYSICIAN Adm Date: 11/12/1999 DOB: 09/10/44 DRUG ALLERGIES
Date Time Another brand of drie ken / in fom and content may be ed unless
checked :unselected:
Demerol 75 mg have received information on Advanced Directives and Organ Tissue Donation. Patient Signature Jak Prom Witness :unselected: :unselected: :unselected:
:unselected: :unselected: :unselected: :unselected: :unselected: :unselected: :selected: :selected: :unselected: NEUROLOGICAL Level of Consciousness: SHIFT INIT
NURSE SIGNATURE
3D
Kim Danielsen
TamFandomRN
13PC
Diana Camp CON
TIME
FOCUS
D, A, R
FOCUS NOTES
0730
Q. CBC + urine
Hernia
3. Chest X-ray
(HKP Dictated)
4 c/C/2 (High)
Recurrent
5 CmP
6) Protime + 95+
2 Prep
8 PSA
9 epidural or spinal anesthesia
11/12/99
Phisohex Prep
0005
Dr. more - Have a Happy Day
Dperche RN
-
noted @ 0035 11/11/99
SM
11/12
1 Ice pack
2 up when neurologically normal + alost
3 15 1/2 NS 125 cc/hr Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Community General Hospital 11/12/99- 11/3/99 1 MEDICATION ADMINISTRATION
RECORD
LLERGIES
MEDICATION ADMINISTRATION TIMES
7:01 - 15:00
15:01 - 23:00
23:01 -
TIME
- - SITE ; !
INITIAL
TIME
1 1 SITE ,
INITIAL -
TIME 1
SI
Keftabs 50mg po
Demerol 50mg IN Post-op. Greater than 75 Years Other* Refer to 24 Hr. Nursing Flowsheet INSTRUCTIONS: if points total 15 or more, implement Fall Risk Plan. Score Each Shift
SPECIMEN SENT
DIAGNOSTIC TEST OR THERAPY
TIME OUT
TIME
Form #8002088 (Rev. 1/98) Page 1 of 4 INTRAVENOUS THERAPY FLOW SHEET
FLUID DOCUMENTATION
TIME
AMOUNT
IV SOLUTIONS,
ADDITIVES
RATE
TUBINGA
PUMP
INITIALS
6933
100
D5 /2NS
125 Chuck Hamlin, M.D. Radiologist Chuck Hamlin Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Physician: Jeff T.
Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Surgery Consent Form 1. I hereby authorize Dr. Moore and whomever he may DATE/TIME: 11/12/99 Community General Hospital Anytown, USA TRANSITION/DISCHARGE PLANNING ASSESSMENT .* Name: John Brown Account No:
12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 COMMUNITY SERVICES: CURRENTLY SM
Form 1266 C BRIGGS, Des Moines, IA 50306 (800) 247-2343 PRINTED IN U.S.A. PLEASE! USE BALL POINT PEN ONLY PHYSICIAN'S ORDERS Order Form"

response =  """# Document Summary #
## Patient Information: ## 
- Name: John Brown
- Age: 54 years
- Gender: Male
- Payer: Southern Company
  
## Provider Information: ##
- Attending Physician: Jeff T. Moore, M.D.
- Consulting Physician(s): Chuck Hamlin, M.D., Marek Dobke, M.D.
- Speciality(ies): Radiology, Surgery
  
## Medical History of illness: ##
The patient's medical history before admission is not mentioned in the provided documents.
  
## Current Diagnosis (Provisional): ##
The patient has been diagnosed with a right inguinal hernia (National Code - 49520) and secondary diagnosis of lipoma of skin and subcutaneous tissue of trunk (National Code - 214.4).
  
## Clinical Assessment(Medical reports): ##
Medical reports indicate that the patient was admitted to Community General Hospital on November 12th, 1999 at 11.10 am as an Inpatient under the care of Dr. Jeff T. Moore for surgical treatment for his right inguinal hernia.
  
## Diagnostic tests that confirm patient has health issue mentioned in diagnosis: ##
Diagnostic tests are not mentioned in the provided documents.
  
## Past Surgical History:
Past surgical history is not mentioned in the provided documents.
  
## Treatment (Proposed Treatment or procedure, medication,dosages,route & Duration of procedure):
The proposed treatment for John Brown includes surgery for his right inguinal hernia performed by Dr. Marek Dobke on November 12th,1999 using Extra Large Plug REF01146 and REF01172.
Medication administered during hospitalization included Midazolam IV OCT OR ON1 CALL from November 11th to November13th as per Medication Administration Record chart.
  
## Patient's Perspective (Patient has expressed his/her willingness to try and aware of potential side effects--Consent to treatment):
John Brown signed Consent To Treatment And Conditions Of Admission form indicating he understood all conditions related to admission including authorization given for dispensing nonproprietary name products identical in dosage form unless otherwise specified under S.G.M.C Formulary Management System.He also signed Discharge Instruction Sheet acknowledging receipt copy Notice Of Privacy Practices document.
  
## Follow up for patient with physician(Hospital Course):
The follow-up plan after discharge is not mentioned in the provided documents.

## Provider Expertise:
Dr.Jeff T.Moore,M.D.is an attending physician who specializes in Internal Medicine while Dr.Chuck Hamlin,M.D.specializes in Radiology,and Dr.Marek Dobke specializesin Surgery.Their expertise aligns with their respective fields which makes them qualified healthcare providers treating patients like John Brown effectively."""

eval_score = eval_obj.evaluate(context=context,response=response,metric="Agreement Score")
print(eval_score)

Configuration Options:  (these options have not been included in the implementation of QT package – version 1 )
  n_questions: int
  Number of questions to generate.
  More questions = more accurate, granular evaluations, but it will also mean higher evaluation time, and LLM inference cost.
  questions: List[str]
  If you would like to ask custom questions instead of generating the questions, you can provide a list of questions using the constructor argument questions.
  question_answerer: QuestionAnswerer
  You can also configure which LLM prompting technique to use for answering questions:
  QuestionAnswererBulk (faster, cheaper, default): uses a single prompt to answer all the questions.
  QuestionAnswererChainOfThought (slower, uses more tokens, better reasoning): will prompt the LLM separately for each question, wrapped in a chain of thought prompt.
  QuestionAnswererWithRetrieval: (good for large documents) uses a simple similarity search to narrow-down context.

<b>These are the questions generated by the metric for the above summary:</b>
  ['Is John Brown a male patient?', 
  'Was John Brown admitted to Community General Hospital on November 12th, 1999?', 
  'Was Dr. Jeff T. Moore the attending physician for John Brown?', 
  'Did John Brown have a right inguinal hernia?', 
  'Did John Brown have a lipoma of skin and subcutaneous tissue of trunk?', 
  'Was surgery performed on John Brown for his right inguinal hernia?', 
  'Did Dr. Marek Dobke perform the surgery on John Brown?', 
  'Was Midazolam IV administered to John Brown during his hospitalization?', 
  'Did John Brown sign the Consent To Treatment And Conditions Of Admission form?', 
  'Is Dr. Chuck Hamlin a radiologist?']

<b>Source: </b>
<a href="https://docs.athina.ai/evals/preset-evals/summarization-qa" target="_blank">Summarization Q&A - Athina </a>
        
        
      </div>

      <div id="matrSum_coverage">
        <h2 class="pageTitle">Accuracy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_agreement')">Agreement Score</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_coverage')">Coverage Score</button>
          <button class="button button2" onClick="clickCalled('matrSum_summa')">SummaCConv</button>
        </div>
(This is an LLM Based Evaluator)

The summarization metric uses LLMs to determine whether your LLM (application) is generating factually correct summaries while including the necessary details from the original text. The coverage score is a part of the summarization metric and determines whether the summary contains the necessary information from the original text. It quantifies how well a summary captures and accurately represents key information from the original text, with a higher score indicating greater comprehensiveness.

Calculation (include input, calculation/ formula, output details)
  Focuses on coverage of details from the original text. Measures the amount of detail included in the summary from the original text. 

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>original text/ input:</b> The source document that contains the information that should be summarized.
<b>actual output:</b> The LLM generated summary of the source document.

Step 1. n close ended questions are generated from the original text that can only be answered with a 'yes' or 'no'.

Step 2: Calculate the ratio of questions to which both the original text and the summary give the same answer.

Step 3: Higher the number of matching answers, greater the coverage score. Matching answers indicate the summary is both factually correct and contains sufficient detail to answer the question. 

<b>Output: </b>
The percentage of questions that had identical answers for both contexts. A number between 0 and 1. 

<b>Example : </b>

#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric(n_questions: i)

context = "Patient Name: Ms. Jane Doe  
MRN:M1234  
Mob -1234 -09878 -8800  
Address - 13th Street. 47 W 13th St, New York, NY 10011  

DIGNOSIS:  [Type 1] Diabetes Mellitus /E10.9  
Instruction:  Should follow  diet and exercise/oral medication/insulin through self -administration of 
injections multiple times a day via an insulin pen  

CPT Code:  95249 Certificate of Medical Necessity:  
Continuous Glucose Monitoring Supplies (CGM) Medicaid Letter  
Date   09/10/2023  
Patient Name  Ms. Jane Doe  
Date of Birth   05/10/1967  

We are seeking to continue to better manage this patient's diabetes by using : 
â–¡ FreeStyle  Libre (14 -day or Libre 2) continuous glucose monitor system  
  â–¡ DexCom  G6 continuous glucose monitor system Notes:  Ms. Doe has diabetes com plications, such as neuropathy or retinopathy, which may  cause 
nerve damage/vision loss/other limitations and substantially limits her ability to walk/see/care for 
herself/perform other life activities. As a result, it is my medical opinion that Ms. Doe ne eds CGM  to 
get real-time updates . Please contact me if you have any questions.  

Dr. John Smith diagnosed with diabetes.    

Clinician Name (Printed): _ Dr. John Smith ____________________________________________  
Clinician Signature: ________________________________________________________  
NPI: __  MD2234 ____________________  
Date: _______ 09/10/2023 ______________ for appropriate age range, testing and calibration requirements, etc.   
â€¢ Or patient has otherwise qualifying circumstances or otherwise deemed 
medically necessary  

The patient and I are requesting these continuous glucose monitoring supplies be approved to 
continue to help improve their glycemia and thus their long -term qual ity of life as someone 
diagnosed with diabetes. injections multiple times a day via an insulin pen  

CPT Code:  95249  
CPT Description:  Continuous Glucose Monitoring (CGM)  
CGM Details:  
============  
CGM Model :  Dexcom G6  
Sensor Duration -10 days  
Frequency of use -Continuous  
Notes:  Ms. Doe has diabetes com plications, such as neuropathy or retinopathy, which may  cause | Diagnosing Diabetes | >= 6.5 |
| Therapeutic goals for glycemic| Age > 19 years 
| control | . Goal of therapy: < 7.0 |
| | . Action suggested: > 8.0 |
|
| | Age < 19 years |
| | . Goal of therapy: <7.5 |
------------------------------------------------------------------
---Bio-Chemistry Date:08-12-2023 Test Name Result NORMAL UNITS
FBS (Fasting Blood Sugar ) 120 70-110 mg.dL
PPBS (  Postprandial Glucose) 190 110-140 mg.dLBio-Chemistry (Sugar Profile) â€¢ Requires frequent adjustment of insulin dosage   
â€¢ Has received education specific to the use of therapeutic CGM  
â€¢ Had an in -person or telehealth visit within the last 6 months with the treating 
clinician to evaluate diabetes control   
Provider has verified the patient meets the manufacturer's recommendations 
for appropriate age range, testing and calibration requirements, etc. get real-time updates . Please contact me if you have any questions.  

Dr. John Smith  
Endocrinologists,  Endocrinologists Associates  
Contact:123 -9909 -2890  
License number ( NPI) -MD2234  
                                                                        New Life Healthcare  
                                                            Dr. J ohn Smith BEFORE (FBS) AFTER (PP) BEFORE (FBS) AFTER (PP) BEFORE (FBS) AFTER (PP)
04/08/23 130 190 145 180 140 220 160
05/08/23 120 180 120 210 120 180 170
06/08/23 150 200 150 230 150 200 180
07/08/23 130 220 130 220 130 220 190
09/08/23 170 170 170 300 170 170 200
10/08/23 150 190 150 180 150 190 220
11/08/23 160 180 160 170 160 180 170
12/08/23 180 160 180 240 180 160 180Blood Glucose Logs Dr. J ohn Smith  
                                                    132, My Street,  Kingston,  
                                                            New York 12401 . 11/08/23 160 180 160 170 160 180 170
12/08/23 180 160 180 240 180 160 180Blood Glucose Logs
DateBreafast Lunch DinnerBedTime â–¡ DexCom  G6 continuous glucose monitor system  
â–¡ Eversense  continuous glucose monitor system  
â–¡  Medtronic Guardian  continuous glucose monitor system  

This patient:  
â€¢ Self-monitors blood glucose a minimum of 3 times per day   
â€¢ Uses an insulin pump or MDI a minimum of 3 times per day  
â€¢ Requires frequent adjustment of insulin dosage Test Name Results NORMAL UNITS
HbA1c (GLYCOSYLATED HEMOGLOBIN), BLOOD 6.9 %
Interpretation
============
| As per American Diabetes Association (ADA) |
| Reference Group | HbA1c in % |
==============================
| Non diabetic adults >=18 years| <5.7 |
| At risk (Prediabetes) | 5.7 - 6.4 |
| Diagnosing Diabetes | >= 6.5 |
| Therapeutic goals for glycemic| Age > 19 years"

response =  """# Document Summary #

## Patient Information: ##
- Name: Ms. Jane Doe
- Age: 56 years old
- Gender: Not specified
- Payer: Medicaid
- Medical Record Number (MRN): M1234

## Provider Information: ##
- Name: Dr. John Smith 
- Speciality: Endocrinologists, Endocrinologists Associates 
- Contact information:
  - Phone number : 123 -9909 -2890  
  - Address : 132, My Street, Kingston, New York 12401.
  - License number ( NPI) : MD2234 

## Medical History of illness: ##
Ms. Jane Doe has been diagnosed with Type 1 Diabetes Mellitus/E10.9 and is experiencing complications such as neuropathy or retinopathy that may cause nerve damage/vision loss/other limitations.

## Current Dignosis (Provisional): ## 
Ms. Jane Doe's current diagnosis is Type 1 Diabetes Mellitus/E10.9.
National Code (CPT Code): 95249
National Code (CPT Description): Continuous Glucose Monitoring (CGM)

## Clinical Assessment(Medical reports): ## 
Dr. John Smith recommends the use of continuous glucose monitoring supplies to better manage Ms.Jane Doe's diabetes and improve her glycemia in real-time updates.

The recommended CGM models are FreeStyle Libre(14-day or Libre2) continuous glucose monitor system and DexCom G6 continuous glucose monitor system.

Dr.John Smith also notes that Ms.Doe requires frequent adjustment of insulin dosage due to her condition.

Blood Glucose Logs show fluctuations in blood sugar levels before and after meals over a period from August to December in the year 2023.

HbA1c test results indicate that Ms.Doe has a HbA1c level of 6.9%, which falls under therapeutic goals for glycemic control for age >19 years according to American Diabetes Association guidelines.

## Diagnostic tests that confirms patient has health issue mentioned in diagnosis:
None mentioned explicitly

## Past Surgical History:
Not provided

## Treatment(Proposed Treatment or procedure, medication,dosages,route & Duration of procedure):
Ms.Jane Doe should follow diet and exercise/oral medication/insulin through self-administration of injections multiple times a day via an insulin pen(CPT code :95249).
Dr.John Smith recommends using either FreeStyle Libre(14-day or Libre2) continuous glucose monitor system or DexCom G6 continuous glucose monitor system based on their medical opinion.
### Requirements for Therapeutic CGM usage ###
â€¢ Requires frequent adjustment of insulin dosage   
â€¢ Has received education specific to the use of therapeutic CGM  
â€¢ Had an in-person or telehealth visit within the last six months with the treating clinician to evaluate diabetes control   
â€¢ Provider has verified the patient meets the manufacturer's recommendations for appropriate age range, testing and calibration requirements etc.

## Patient's Perspective(Patient has expressed his/her willingness to try and aware of potential side effects--Consent to treatment):
Not provided

### Follow up for patient with physician(Hospital Course):
No hospital course was mentioned explicitly but it can be inferred from Dr.Smithâ€™s note requesting approval for continuing CGM supplies.

### Provider Expertise:
Endocrinologist"""

eval_score = eval_obj.evaluate(context=context,response=response,metric="Coverage Score")

print(eval_score)




<b>Configuration Options:</b>
There are eight optional parameters when instantiating an SummarizationMetric class:

Note: Set the strict mode to True to indicate a perfect result and to reject any other score. 

• [Optional] threshold: the passing threshold, defaulted to 0.5.  
• [Optional] assessment_questions: a list of close-ended questions that can be answered with either a 'yes' or a 'no'. These are questions you want your summary to be able to ideally answer, and is especially helpful if you already know what a good summary for your use case looks like. If assessment_questions is not provided, a set of assessment_questions are generated at evaluation time. The assessment_questions are used to calculate the coverage_score.
• [Optional] n: the number of assessment questions to generate when assessment_questions is not provided. Defaulted to 5.
• [Optional] model: a string specifying which of OpenAI's GPT models to use, OR any custom LLM model of type DeepEvalBaseLLM. Defaulted to 'gpt-4o'.
• [Optional] include_reason: a boolean which when set to True, will include a reason for its evaluation score. Defaulted to True.
• [Optional] strict_mode: a boolean which when set to True, enforces a strict evaluation criterion. In strict mode, the metric score becomes binary: a score of 1 indicates a perfect result, and any outcome less than perfect is scored as 0. Defaulted as False.
• [Optional] async_mode: a boolean which when set to True, enables concurrent execution within the measure() method. Defaulted to True.
(async_mode = True indicates that the step 2, where the answers are extracted from both the document and the summary/ any steps that are independent will be executed concurrently, while False will cause them to be executed sequentially).
• [Optional] verbose_mode: a boolean which when set to True, prints the intermediate steps used to calculate said metric to the console, as outlined in the How Is It Calculated section. Defaulted to False. 

Questions Generated by the metric for generating Y/N answers:



<b>Source:</b> 

<a href="https://docs.confident-ai.com/docs/metrics-summarization" target="_blank">Summarization | DeepEval</a>

Further Reading/ Details: 
<a href="https://docs.confident-ai.com/docs/metrics-introduction#measuring-metrics-in-async" target="_blank">1. Introduction | DeepEval - The Open-Source LLM Evaluation Framework (confident-ai.com)</a>
<a href="https://www.confident-ai.com/blog/a-step-by-step-guide-to-evaluating-an-llm-text-summarization-task" target="_blank">2. A Step-By-Step Guide to Evaluating an LLM Text Summarization Task - Confident AI (confident-ai.com) </a>
      </div>

      <div id="matrSum_summa">
        <h2 class="pageTitle">Accuracy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_agreement')">Agreement Score</button>
          <button class="button button2" onClick="clickCalled('matrSum_coverage')">Coverage Score</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_summa')">SummaCConv</button>
        </div>
This metric has not been implemented in QT package due to dependency issues.
(This is a NLI model based evaluator)

Evaluates factual consistency of summary with input documents. It is based on the aggregation of sentence-level entailment scores for each pair of input document and summary sentences.

<b>Details: </b>

  • This metric measures the factual consistency of the summary with the input document. 
  • Uses natural language inference models for inconsistency detection.
  • Provides a method called SummaCConv that enables NLI models to be used for summarization by segmenting documents into sentences and aggregating scores between pairs of sentences. 
  • SummaCConv is a trained model consisting of a single learned convolution layer compiling the distribution of entailment scores of all document sentences into a single score. 

<b>Calculation:</b>
  • Generate an NLI pair matrix by splitting the document and the summary into sentence blocks. 
  • The document is split into M blocks, and the summary into N blocks. 
  • Each combination (Mi,Nj) is run through the NLI model to generate a probability distribution for (entailment, contradiction, neutral).
  • For each summary sentence, the score for the document sentence that provides the strongest support for each summary sentence is retained. 
  •  SummaCConv : Each summary sentence is scored and an average is obtained as the final summary-level score. 

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>original text/ input:</b> The source document that contains the information that should be summarized.
<b>actual output:</b> The LLM generated summary of the source document.

<b>Output: </b>

  A number between 0 and 1. 


<b>Example: (add a healthcare example)</b>
from summac.model_summac import SummaCZS, SummaCConv
  
model_zs = SummaCZS(granularity="sentence", model_name="vitc", device="cpu") # If you have a GPU: switch to: device="cuda"
model_conv = SummaCConv(models=["vitc"], bins='percentile', granularity="sentence", nli_labels="e", device="cpu", start_file="default", agg="mean")
  
# Example medical text to summarize
text = """
A 45-year-old male patient with a history of hypertension and type 2 diabetes mellitus presented with a two-week history of progressive shortness of breath, fatigue, and swelling of the lower extremities. On physical examination, the patient had bilateral pitting edema up to the knees, jugular venous distension, and an S3 heart sound. Laboratory tests revealed elevated B-type natriuretic peptide (BNP) levels, and a chest X-ray showed cardiomegaly with pulmonary congestion. An echocardiogram demonstrated a reduced ejection fraction of 30%, consistent with systolic heart failure. The patient was admitted to the hospital and started on diuretics, ACE inhibitors, and beta-blockers. After stabilization, the patient was discharged with instructions for close outpatient follow-up and lifestyle modifications.
"""

summary1 = "  "
score_conv1 = model_conv.score([document], [summary1])
print("[Summary 1]  SummacConv score: %.3f" % (score_conv1["scores"][0])) 
# [Summary 1] 
  


<b>Sources: </b>
  <a href="https://arxiv.org/pdf/2111.09525" target="_blank">1. 2111.09525 (arxiv.org) </a>
  <a href="https://github.com/tingofurro/summac" target="_blank">2. tingofurro/summac: Codebase, data and models for the SummaC paper in TACL (github.com)</a>
        
      </div>

      <div id="matrSum_supert">
        <h2 class="pageTitle">Relevancy</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrSum_supert')">SUPERT</button>
          <button class="button button2" onClick="clickCalled('matrSum_relevance')">Summary Relevance</button>
        </div>
This metric has not been implemented due to dependency issues.

SUPERT rates the quality of a summary by measuring its semantic similarity with a pseudo reference summary, i.e. selected salient sentences from the source documents, using contextualized embeddings and soft token alignment techniques. 

<b>Details: </b>
  • Objective is to evaluate multi-document summaries without using human annotations or reference summaries. 
  • Focus on measuring how much of information from the source documents is covered by the summary.

<b>Calculation:</b>
  • SUPERT evaluates the quality of a summary by measuring its semantic similarity to a pseudo reference summary. 
  • This pseudo reference is created by selecting salient sentences from the source documents.

<b>Steps involved in calculation:</b>
  • Identify the salient information in the input documents, to build a pseudo reference. 
  • Measure the semantic overlap between the pseudo reference and the summary to be evaluated. 
  • The resulting evaluation is called SUPERT (SUmmarization evaluation with Pseudo references and bERT).
  • Proposed method, Top+Clique to build pseudo summaries:
    ○ Label top-N sentences from each document as salient. 
    ○ With the remaining (non-top-N) sentences, build a graph such that only "highly similar" sentences have an edge between them. 
    ○ Obtain the cliques from the graph and select the semantically central sentence from each clique as potentially salient sentences. 
    ○ For each potentially salient sentence, label as salient if it is not highly similar to any top-N sentences. 
    ○ N = 10, and threshold for highly similar is 0.75. 
  • Note: A clique in a graph is a group of nodes (or in this case, sentences) where every node is directly connected to every other node in the group. In simpler terms, a clique here is a set of sentences that are all closely related or similar to each other.
  • The most central sentence is the one that's the most similar to the other sentences in that clique.
  • Use SBERT to measure the similarity between the summary and the pseudo reference. 
  • SUPERT can be used as rewards to train an RL - based - summarizer. 
  
<b>Required Arguments: (your dataset must contain these fields)</b>

<b>original text/ input:</b> The source document that contains the information that should be summarized.
<b>actual output:</b> The LLM generated summary of the source document.

<b>Output: </b>

  A number between 0 and 1. 

<b>Example: </b>
from ref_free_metrics.supert import Supert
from utils.data_reader import CorpusReader

# read docs and summaries
reader = CorpusReader('data/topic_1')
source_docs = reader()
summaries = reader.readSummaries() 

# compute the Supert scores
supert = Supert(source_docs, ref_metric='top15') 
scores = supert(summaries)

# In this example, it extracts top-15 sentences from each source 
# document to build the pseudo reference summaries, and rate the 
# summaries by measuring their semantic similarity with the pseudo 
# references. 


<b>Source: </b>
  1. <a href="https://github.com/yg211/acl20-ref-free-eval" target="_blank">SUPERT: Unsupervised multi-document summarization evaluation & generation (github.com)</a>
  2. <a href="https://aclanthology.org/2020.acl-main.124.pdf" target="_blank">SUPERT: Towards New Frontiers in Unsupervised Evaluation Metrics for Multi-Document Summarization (aclanthology.org)</a>
        
      </div>

      <div id="matrSum_relevance">
        <h2 class="pageTitle">Relevancy</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_supert')">SUPERT</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_relevance')">Summary Relevance</button>
        </div>
(This is an LLM Based Evaluator)

Evaluates if the summary includes only important information and excludes redundancies.

<b>Calculation (include input, calculation/ formula, output details)</b>
  Prompts are crafted for this criteria, taking the original document and the summary as inputs, and leveraging chain-of-thought generation and guiding the model to output a numeric score from 1-5 for the criteria.
  
  Scores are generated from gpt-4 with the defined prompts, comparing them across summaries.

<b>Required Arguments: (your dataset must contain these fields)</b>
  <b>original text/ input:</b> The source document that contains the information that should be summarized.
  <b>actual output:</b> The LLM generated summary of the source document.
  
  Step 1: Uses prompts to instruct an LLM to score the summary on relevancy. 
  Step 2: Uses a direct scoring function where gpt-4/ any LLM generates a discrete score (1-5) for the metric.
  Step 3: Converts it to a metric between 0 and 1. 
  
  Output: Is a value between 0 and 1. The higher the value, more relevant the summary to the document. 
  
<b>Example :</b>
#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric()
  
context = "for follow up visit. The patient is a 23 year old male. History Allergy Penicillins [Drug allergy]: Rash Past
Medical CPT2 DEFICIENCY (E71.314) FOLLOW-UP SURGERY CARE (Z09) ARACHNOID CYST OF
SPINE (G96.198) Other Medical History ENCOUNTER FOR EDUCATION (Z71.9) Past Surgical 1 wrist
surgery 9-27-16 fx radius Laminectomy (07/21/2017) Elective Admission-SS CCMC-L2 and L3 left edited the report where appropriate. Page 1 of 2 Date Printed: 5/17/2019'4:52 PM P010/011 Nov 28
2023 11:05am Fax:516-354-8597 L | NEUROSURGICAL PAGE 3/11 Âª RCVD AT 11/28/2023 11:17:54 AM [Eastern Standard Time] * SVR:DALRF16RDT03/37 *
DNIS: 18061* CSID:516 354 8597 * ANI:5163546401 * DURATION (mm-ss):03-22 Patient Message
mom called To: From: Sent: 5/8/2023 2:42 PM Phone: (631) 424-6304 mom called said that have been
having headaches and has a weird "bubble" feeling in his head. Do you want to send him for a scan having headaches and has a weird "bubble" feeling in his head. Do you want to send him for a scan
first or come In for eval .. Please advise, I can call mom back to let her know # mom Veradiam EHR
23.4 Allscripts: 11/28/2023 10:59 am Page 1/1 P003/011 Nov 28 2023 11:03am Fax:516-354-8597 L |
NEUROSURGICAL :selected: :unselected: :unselected: PAGE 2/11 * RCVD AT 11/28/2023 11:17:54 AM [Eastern Standard Time] " SVR:DALRF 16RDT03/37
* DNIS: 18061 * CSID:516 354 8597 * ANI:5163546401 * DURATION (mm-ss):03-22 Procedure Order
Ordering SiteLong Island Neurosurgical Main Office 410 Lakeville Rd.suite 204 New Hyde Park, NY
11042 (516) 354-3401 Fax: (516) 354-8597Report Date: 05/17/2023Patient InformationZ Patient DICT: STEVEN J SCHNEIDER, M.D. (07123) 07/21/2017 03:53 PM TRANS:
V_TSRAA_T/V_TSPRV_Q 07/21/2017 08:58 PM JOB: 2182906 Page 2 of 2 P007/011 Nov 28 2023
11:04am Fax:516-354-8597 L | NEUROSURGICAL :unselected: Horowitz, FNP( ) Cathy Grimm - Admin ( ) Staff Member ( ) * urgent & DATE: 1 128/23 . TO THE
ATTENTION OF: Medical review FAX NUMBER: 866-889-8061 THIS TRANSMISSION HAS 11
PAGES INCLUDING COVER SHEET FROM: REGARDING: L 200 The information contained in this
facsmile message is priveledged message is privileged and confidential information intended only for Patient MRN: CRAIG WARSHALL M.D., ATTENDING RADIOLOGIST Patient Proc Dirte: 05/14/2019
Ord #: 9002 As the Attending Physician, I personally performed the professional interpretation of the
study, personally supervised the professional interpretation of the study and/or reviewed the images
and the interpretation of the resident, and have edited the report where appropriate: It this is an has been electronically signed. CRAIG WARSHALL M.D., ATTENDING RADIOLOGIST This document
has been electronically signed. May 15, 2019 12:03PM Addend: CRAIG WARSHALL M.D.,
ATTENDING RADIOLOGIST This addendum was electronically signed on: May 17 2019 4:49PM
Patient MRN: CRAIG WARSHALL M.D., ATTENDING RADIOLOGIST Patient Proc Dirte: 05/14/2019 PAGE 6/11 / RCVD AT 11/28/2023 11:17:54 AM (Eastern Standard Time] Â· SVR:DALRF16RDT03/37 +
DNIS: 18061 * CSID:516 354 8597 + ANI:5163546401 . DURATION (mm-ss):03-22 NORTHWELL
HEALTH LONG ISLAND JEWISH MEDICAL CENTER - 270-05 76th AVENUE, NEW HYDE PARK,
NEW YORK, 11010 * (516) 470-7000 PATIENT NAME: DATE OF OPERATION: 07/21/2017 MEDICAL PAGE 1/11 Âº RCVD AT 11/28/2023 11:17:54 AM (Eastern Standard Time] " SVR:DALRF16RDT03/37 +
DNIS: 18061 * CSID:516 354 8597 * ANI:5163546401 * DURATION (mm-ss):03-22 FAX
TRANSMITTAL COVER SHEET PRIVILEGED AND CONFIDENTIAL INFORMATION LONG ISLAND
NEUROSURGICAL ASSOCIATES P.C & COHEN CHILDREN'S MEDICAL CENTER PEDIATRIC
NEUROSURGERY 410 LAKEVILLE ROAD, STE #204 NEW HYDE PARK, NY 11042 TEL# (516) 11/03/2020 3:55:59 PM -0500 NORTHWELL HEALTH PAGE 3 OF 3 Northwell Reichert Family
Imaging at Huntington An Extentton of North Shore University Hospital 284 Pulaski Rond, Greenlawn,
NY 11740 (531) 570-3458 (581) 670-8497 Department of Radiology IMPRESSION: A ventral epidural
lesion extending from the 18-19 level to the L4 level. The leston demonstrates fluid signal and Intemal PAGE 4/11 * RCVD AT 11/28/2023 11:17:54 AM (Eastern Standard Time] . SVR:DALRF 16RDT03/37
* DNIS: 18061 * CSID: 516 354 8597 . ANI:5163546401 * DURATION (mm-ss):03-22 LI NA LONG
ISLAND NEUROSURGICAL ASSOCIATES 11/18/2020 01:00 PM Location: Long Island Neurosurgical
Main Office STEVEN J. SCHNEIDER, MD, FAANS, FACS, FAAP MARK A. MITTLER, MD, FAANS, point, he tolerated the storing warestable, and he was taken to the ke covery room in a stable
conditions extremities well. Pler It the operating surgeon fre lig beginn cedure. We utilized in. and
extradurally for ie cystic lesion. case to the end of the case. operative microscope for the majority of the
DICT: STEVEN J SCHNEIDER, M.D. (07123) 07/21/2017 03:53 PM TRANS: PAGE 7/11 . RCVD AT 11/28/2023 11:17:54 AM (Eastern Standard Time) " SVR:DALRF16RDT03/37 "
DNIS: 18061 * CSID:516 354 8597 * ANI:5163546401 * DURATION (mm-ss):03-22 NORTHWELL
HEALTH LONG ISLAND JEWISH MEDICAL CENTER 270-05 76th AVENUE, NEW HYDE PARK,
NEW YORK, 11040 + (516) 410-7000 PATIENT NAME: MEDICAL RECORD #: DATE OF BIRTH: from 11042 (516) 354-3401 Fax: (516) 354-8597Report Date: 05/17/2023Patient InformationZ Patient
Insurance InformationCollection Agency Group #NONE Plan #NONE119891913Procedures Ordered
MRI - Brain W/O Contrast (70551) Case # Diagnosis: ARACHNOID CYST OF SPINE (G96.198)
Ordered by: Shanna L. Baron, FNP MRI CERVICAL SPINE W/O CONTRAST (72141) case # PAGE 6/11 * RCVD AT 11/28/2023 11:17:54 AM (Eastern Standard Time] " SVR:DALRF16RDT03/37 *
DNIS: 18061 * CSID:516 354 8597 * ANI:5163546401 * DURATION (mm-ss):03-22 11/18/2020 01:19
PM Weight: 163 lb Height: 70 in Body Surface Area: 1.91 m2 Body Mass Index: 23.39 kg/m2 --- Temp .:
96.6 ÂºF Assessment & Plan ARACHNOID CYST OF SPINE (G96.198) --- -- returns to office for follow- NEW YORK, 11010 * (516) 470-7000 PATIENT NAME: DATE OF OPERATION: 07/21/2017 MEDICAL
RECORD #: ENCOUNTER #: SURGEON: DATE OF BIRTH: OPERATIVE REPORT ASSISTANT:
PREOPERATIVE DIAGNOSIS: Extradural and internal cystic delnal levien. OPERATION: L2 and L3
left hemilaminectomy, 82-L3 m tomny and foraminotomy Onstruction of dorsal ces for difficult anatomic Order #: 90030EXAM: MR SPINE CERVICAL EXAM: MR SPINE LUMBAR EXAM: MR SPINE
THORACICPROCEDURE DATE: 11/02/2020INTERPRETATION: CLINICAL INFORMATION:
ROUTINE. . ADMDIAG1: G96.198 OTHER DISORDERS OF MENINGES, NOT ELSEWHERE
CLASSIFIED/. Arachnoid cyst status post fenestration. Follow-up.TECHNIQUE: Multiplanar
multisequence was performed.noncontrast MRI of the cervical, thoracic and lumbar Main Office STEVEN J. SCHNEIDER, MD, FAANS, FACS, FAAP MARK A. MITTLER, MD, FAANS,
FACS, FAAP MICHAEL A. LEFKOWITZ, MD, FAANS, FACS SHAUN D. RODGERS, MD SHANNA L.
BARON, RN, MSN, FNP-C 1 Marital status: single / Language: English / Race: White / Ethnicity: Not
Hispanic or Latino Gender: Male History of Present Illness Patient words: The patient presents today disc signal is preserved. No significant Page 1'ol 2 Date Printed; 11/3/2020 3:47 PM 110/800d L |
NEUROSURGICAL Nov 28 2023 11:04am Fax:516-354-8597 ARACHNOID CYST OF SPINE (G96.198) Ordered by: Shanna L. Baron, FNP End of Procedures
Ordered 05/08/2023 05/08/2023 05/08/2023 Shanna Baron FNAC 05/08/2023 Date P002/011 Nov 28
2023 11:03am WWW.LINEUROSURGERY.COM Fax:516-354-8597 L | NEUROSURGICAL F Tage 2
72 :unselected: (72146) case # 1198920939 Note: PLEASE PROVIDE PATIENT WITH DISC Diagnosis: ARACHNOID
CYST OF SPINE (G96.198) Ordered by: Shanna L. Baron, FNP MRI LUMBAR SPINE W/O
CONTRAST (72148) Note: PLEASE PROVIDE PATIENT WITH DISC case # 1198921629 Diagnosis:
ARACHNOID CYST OF SPINE (G96.198) Ordered by: Shanna L. Baron, FNP End of Procedures septations, suggesting an arachnoid cyst. This is decreased in sire compared to 5/14/2019, when It
extended from C3 through LA. PETER LEE MD; Attending Radiologist This document has been
electronically signed. Nov 3 2020 8:44PM Patient: [MRN: Patient #: Date Printed: 11/3/2020 3:47 PM
Page 2 of 2 P009/011 Fax:516-354-8597 Proc Date: 11/02/2020 Ord il: 9003 Nov 28 2023 11:05am L |
NEUROSURGICAL and return the original message to us at the above address via U.S Postal Service. Thank you.
PLEASE NOTIFY US IMMEDIATELY IF ANY OR ALL PAGES ARE NOT RECEIVED P001/011 Nov 28
2023 11:02am Fax:516-354-8597 L | NEUROSURGICAL :unselected: :unselected: :selected:
:unselected: :unselected: :unselected: :unselected: :unselected: :unselected: :unselected: 11/03/2020 3:55:59 PM -0500NORTHWELL HEALTHNorthwell ReichertFamily Imaging at
HuntingtonAn Extension of North Shore University Hospital 284 Pulaski Rond, Greehiswn, NY 11740
(531) 670-3456 (631) 670-3497 Department of RadiologyMR#: EPI #: DOB: AGE: Acct #: Home#:
Order #: 90030EXAM: MR SPINE CERVICAL EXAM: MR SPINE LUMBAR EXAM: MR SPINE PAGE 11/11 * RCVD AT 11/28/2023 11:17:54 AM (Eastern Standard Time] " SVR:DALRF16RDT03/37
' DNIS: 18061 * CSID:516 354 8597 . ANI:5163546401 * DURATION (mm-ss):03-22 05/17/2019
4:59:16 PM -0400 PAGE 3 OF 3 NORTHWELL HEALTH Northwell ReichertFamily Imaging at
HuntingtonAn 284 Pulaski Road,Extension of North Shore University Hospital Greenlawn, NY 11740 PAGE 10/11 * RCVD AT 11/28/2023 11:17:54 AM [Eastern Standard Time] * SVR:DALRF16RDT03/37
* DNIS: 18061 * CSID: 516 354 8597 * ANI:5163546401 * DURATION (mm-ss):03-22 05/17/2019
4:59:16 PM -0400NORTHWELL HEALTHPAGE 2 OF 3Northwell ReichertFamily Imaging at
HuntingtonAn 284 Pulaski Road,Extension of North Shore University Hospital Greenlawn, NY 11740 NEUROSURGERY 410 LAKEVILLE ROAD, STE #204 NEW HYDE PARK, NY 11042 TEL# (516)
354-3401 FAX# (516) 354-8597 WWW.LINEUROSURGERY.COM Steven J Schneider, MD ( ) Mark A.
Mittler, M.D ( ) Michael A. Lefkowitz, MD ( ) Shaun D. Rodgers, M.D ( ) Shanna Baron, FNP ( ) Yael
Horowitz, FNP( ) Cathy Grimm - Admin ( ) Staff Member ( ) * urgent & DATE: 1 128/23 . TO THE Thoughts. Endocrine Not Present- Appetite Changes, Excessive Urination and Thyroid Problems.
Hematology Not Present- Anemia, Blood Clots, Easy Bleeding, Easy Bruising and Enlarged Lymph
Nodes. --- Fax:516-354-8597 L | NEUROSURGICAL P004/011 Nov 28 2023 11:03am epidural arachnoid cyst has decreased in size. It previously spanned from C3-L4, and now spans from
T8-9 to L4. I am pleased with his progress. Plan: Follow- up with physical therapy and possibly pain
management for muscle spasm symptoms. Follow- up as needed. Steven J. Schneider MD 2 ----.
P005/011 Nov 28 2023 11:03am Fax:516-354-8597 L | NEUROSURGICAL HuntingtonAn 284 Pulaski Road,Extension of North Shore University Hospital Greenlawn, NY 11740
(631) 670-3456 (631) 670-3497 Department of Radiology *** ADDENDUM ***Patient:Ã„KA:EPI #:MR#:
DOB:AGE:Acct #:Home#: Order #: 90028 WHAN W NII INEXAM: MR SPINE CERVICALEXAM: MR
SPINE THORACIC EXAM: MR SPINE LUMBAR*** ADDENDUM 05/17/2019 ***History: Multilevel surgery 9-27-16 fx radius Laminectomy (07/21/2017) Elective Admission-SS CCMC-L2 and L3 left
hemilaminectomy, L2-L3 medial facetectomy and foraminotomy for combined extradural and intradural
cystic lesion with microscope, reconstruction of dorsal elements, intraoperative ultrasound and
enhanced surgical services for difficult anatomic location of cystic lesion. Social Current tobacco use: was used to then enter the epidural space and separate the ligamentum flavum Page 1 of 2 P006/011 L
| NEUROSURGICAL Nov 28 2023 11:03am Fax:516-354-8597 SPINE THORACIC EXAM: MR SPINE LUMBAR*** ADDENDUM 05/17/2019 ***History: Multilevel
arachnoid cyst follow-up MRI.*** END OF ADDENDUM 05/17/2019.***PROCEDURE DATE:
05/14/2019INTERPRETATION: Examination: MRIof the cervical, thoracic and lumbar
spine.TECHNIQUE; Sagittal T1-weighted, images of the cervical, thoracic and lumbar spine were NEW YORK, 11040 + (516) 410-7000 PATIENT NAME: MEDICAL RECORD #: DATE OF BIRTH: from
the undersurface of the L3, and hemilaminectomy performed with the Midas gior of the 2 and 3 levels. It
was cut from the medial facet as well. Kerrison rongeur wasut ur and then extended the medial
facetectomy and foraminotomy. Care was taken to pres interarticularis. The L3 nerve root and L2 nerve Page 2 of 2 Date Printed: 5/17/2019 4:52 PM P011/011 Nov 28 2023 11:05am Fax:516-354-8597 L |
NEUROSURGICAL Ordered by: Shanna L. Baron, FNP MRI CERVICAL SPINE W/O CONTRAST (72141) case #
1198920203 Note: PLEASE PROVIDE PATIENT WITH DISC Diagnosis: ARACHNOID CYST OF
SPINE (G96.198) Ordered by: Shanna L. Baron, FNP MRI THORACIC SPINE W/O CONTRAST
(72146) case # 1198920939 Note: PLEASE PROVIDE PATIENT WITH DISC Diagnosis: ARACHNOID Never smoker Dominant Hand: Right handed Patient participates in any physical activities: Yes sports
Current school status: College sophmore Family hydrocephalus uncle Review of Systems General Not
Present- Chills, Fever, Night Sweats and Significant Weight Change. Skin Not Present- Bruising,
Dryness, Excessive Sweating, Hair Loss, New Lesions and Rash. HEENT Not Present- Blurred Vision, wil a history of carnitine immir yitransferase deficiency and a lars possible intradu after two
myelograms. It edullary non. It appeared to be primu y extradural with a Pely contiplex, and the patient
is symptomatic within. The nous, benefits, and potential compilations ourexploring this lesion,
intraduraleod extra hal were explained and acceptedincluding, et not limited to, infection, bleeding,

response =  """# Document Summary #
## Patient Information: ##
- Name: Mike Helen
- Age: Not provided
- Gender: Not provided
- Payer: Not provided
- Medical Record number (if any): Not provided
  
## Provider Information: ##
- Healthcare provider name: Steven J. Schneider, MD, FAANS, FACS, FAAP; Mark A. Mittler, MD, FAANS,
FACS, FAAP; Michael A. Lefkowitz, MD, FAANS,FACS; Shaun D. Rodgers,M.D.; Shanna L.Baron,RN,
MSN,FNP-C.
- Speciality: Neurosurgery and Radiology
  
## Medical History of illness: ##
The patient has been experiencing headaches and a "bubble" feeling in his head.
  
## Current Diagnosis (Provisional): ##
ARACHNOID CYST OF SPINE (G96.198) - MRI Brain W/O Contrast (70551), MRI Cervical Spine W/O Contrast 
(72141), MRI Lumbar Spine W/O Contrast (72148)
  
## Clinical Assessment(Medical reports): ##
The patient is a 23-year-old male with no significant interval changes noted on the latest medical report dated May 17th,
2019.
  
## Diagnostic tests that confirm the patient has health issues mentioned in diagnosis:
MRI Brain W/O Contrast (70551), MRI Cervical Spine W/O Contrast(72141), and MRI Lumbar Spine W/O 
Contrast(72148).
  
## Past Surgical History:
1 wrist surgery on September 27th ,2016 fx radius laminectomy on July 21st ,2017 Elective Admission-
SSCCMC-L2 and L3 left hemilaminectomy,L2-L3 medial facetectomy,and foraminotomy for combined extradural 
and intradural cystic lesion with microscope,reconstruction of dorsal elements,intraoperative ultrasound,and enhanced surgical services for difficult anatomic location of cystic lesion.
  
## Treatment(Proposed Treatment or procedure):
Not specified in the document.
  
## Patient's Perspective(Patient has expressed his/her willingness to try and aware of potential side effects--Consent to treatment):
Not specified in the document.
  
## Follow up for patient with physician(Hospital Course):
The patient was advised to return for follow-up visits after being diagnosed with ARACHNOID CYST OF SPINE(G96.198).
  
## Provider Expertise:
Dr.Steven J.Schneider is specialized in neurosurgery while Dr.Mark A.Mittler specializes in pediatric neurosurgery.
Dr.Michael A.Lefkowitz specializes in neurological surgery while Dr.Shaun D.Rodgers specializesin radiology.Shanna L.Baron is an RN MSN FNP-C who works under their supervision as a nurse practitioner specializingin family medicine/neurology/radiology/psychiatry/geriatrics/internal medicine/pediatrics/women's health/family planning/counseling/education/preventative care/screenings/vaccinations/treatmentof acute illnesses/injuries/chronic conditions/disease management/end-of-life care/hospice care/rehabilitation/sports physicals/travelmedicine/telehealthcare/home healthcare/nursing home visits/house calls/mobile clinics/community outreach programs/public speaking/seminars/workshops/conferences/etc.,as per her credentials listed at LI Neurological Associates P.C.'s website."""

eval_score = eval_obj.evaluate(context=context,response=response,metric="Summary Relevance")

print(eval_score)

<b>Configuration Options: </b>

<b>Source:</b>
<a href="https://cookbook.openai.com/examples/evaluation/how_to_eval_abstractive_summarization" target="_blank">How to evaluate a summarization task | OpenAI Cookbook</a>
        
      </div>

      <div id="matrSum_hallucination">
        <h2 class="pageTitle">Hallucination</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrSum_hallucination')">Hallucination Score</button>
          <button class="button button2" onClick="clickCalled('matrSum_alignment')">Alignment Score</button>
        </div>
(This is an LLM Based Evaluator)

This evaluator checks  for inaccuracies or hallucinated information in the summaries. The evaluator compares information between a source document and an LLM generated summary. The evaluator then generates close ended questions from the summary. It compares the answers from the summary and the document. Hallucination Score is the percentage of questions where the summary answered definitively but the source document answered "unknown". 

This evaluator is to check mismatches / instances where a summary generated by a model provides a clear answer (either "Yes" or "No") to a question based on its content, while the source document indicates uncertainty or lack of clarity (answering "Unknown").

For example, if the source says, "It is unknown if the patient has a specific disease," and the summary says, "The patient does not have the disease," this is problematic because the source did not provide enough evidence to support the definitive "No" claim. In this case, the model introduced new information or assumed certainty that did not exist in the original data, which would be considered hallucination.

<b>Calculation (include input, calculation/ formula, output details)</b>

<b>Required Arguments: (your dataset must contain these fields)</b>

  <b>document:</b> The source document that contains the information that should be summarized.
  <b>response:</b> The LLM generated summary of the source document.
  
  The evaluator compares the information between a source document and an LLM generated summary.
  
  Step 1: Generates N closed-ended (Y/N/Unknown) questions from the summary information.
  Step 2: QuestionAnswerer LLM is used to answer each question given ONLY the summary as context.
  Step 3: QuestionAnswerer LLM is used to answer each question given ONLY the source document as context.
  Step 4: Compare the answers from the summary and document for each question to find the questions for which the summary gave a definitive – Yes/No answer, but the source document answered unknown. 

<b>Output: </b>
  The percentage of questions where the summary answered definitively but the source document answered "unknown". A number between 0 and 1. 

<b>Example : (change the following example code usage to the Q&T package)</b>

<b>Run the evaluation on a single datapoint:</b>
#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric()
  
context = "Father: Substance abuse Allergies penicillin Printed By 11/28/2023 9:51:33 AM Amazing Charts" The
Information on this page is confidential. Any release of this Information requires the written
authorization of the patient listed above. DURATION (mm-ss):03-37 PAGE 2/5 * RCVD AT 11/28/2023
9:54:55 AM [Eastern Standard Time] * SVR:DALRF16RDT03/48 * DNIS: 12406 18882585785 11/28/2023 06:54:03 PST From Kathie Watson-Gray Page 1 of 5 MEDICAL FAX FROM:
TO: (800) 540-2406 SUBJECT: re: case DATE: Tue, 11/28/23, 9:53 AM EST PAGES: 4 (not including
coversheet) INSTRUCTIONS: Hello, I have attached most recent note regarding request for MRI.
Thank you, This fax transmission is for the sole use of the intended recipient(s) and contains and agreed with telehealth consent and requested a video visit today. 11/28/2023 9:51:33 AM Amazing
Charts The Information on this page is confidential. Any release of this Information requires the written
authorization of the patient listed above. PAGE 3/5 * RCVD AT 11/28/2023 9:54:55 AM [Eastern
Standard Time] " SVR:DALRF16RDT03/48 * DNIS:12406 * CSID DURATION (mm-ss):03-37 18882585785 From 11/28/2023 06:54:03 PST Page 4 of 5 Sep 29. 2023 F51 06:57 PM Electronically
Signed By: 11/28/2023 9:51:33 AM Amazing Charts Printed By: The Information on this page is
confidential. Any release of this Information requires the written authorization of the patient listed
above. 9/29/23 8:28 PM PAGE 4/5 * RCVD AT 11/28/2023 9:54:55 AM [Eastern Standard Time] " the patient listed above. PAGE 5/5 * RCVD AT 11/28/2023 9:54:55 AM [Eastern Standard Time] "
SVR:DALRF16RDT03/48 * DNIS: 12406 * CSID: Kathie WatsonGray " ANI:8882585785 * DURATION
(mm-ss):03-37 food for 3 days, # 3, RF: 0. (Transmitted by Kathie Watson-Gray, MD) marshall pharmacyRTO 5
weeks, call before then if pain worsens. If pain develops into numbness or weakness of the leg, pt will
go to Baptist hospital ER for evaluation immediatelyPROVIDED: Patient Education (9/29/2023)
Viniyoga for low back pain, do not do exercises that cause or Increase painSMMC severe that her mood is deteriorating and it is difficult to concentrate ROS GEN:Patient denles any
fever, chills, or malaise. Feeling generally well other than current pain PMH ADHD h/o abuse as a child
herniated disc 2022 chronic EBV Surgery Tonsillectomy Hospital stays Age 14, serotonin shock
syndrome, was on 3 SSRis and a mood stabilizer after mis-diagosis of bipolar 1 week stay with Initial (4/2022) went to urgent care - given steroids, went to 8 months of PT, that did not improve pain. In the
past steroids didn't help much. She took some ibuprofen, devil's claw, willow bark. The pain is so
severe that her mood is deteriorating and it is difficult to concentrate ROS GEN:Patient denles any fax? You can view it online at http://serenitymd.myupdox.com by entering the following information:
This fax expires on Dec 3, 2023 9:53:43 AM. It will not be available online after that time. PAGE 1/5 *
RCVD AT 11/28/2023 9:54:55 AM [Eastern Standard Time] " SVR:DALRF16RDT03/48 * DNIS:12406 *
CSID:Kathle WatsonGray " ANI:8882585785 * DURATION (mm-ss):03-37 From 18882585785 11/28/2023 06:54:03 PST Page 2 of 5 Serenity Health Care, PLLC 1610 Argillite
Road Flatwoods, KY 41139 Phone (888) 756-4224 Fax (888) 258-5785 Sep 29. 2023 Fr1 06:57 PM CC
Acute care visit, recently worsened back pain HPI Painting a ceiling with a heavy paint sprayer and she
leaned to the right side and her back started hurting 1 week ago. No pop, snap or tearing sensation. From 18882585785 11/28/2023 06:54:03 PST Page 3 of 5 523 FRI.06.57 PM Meds 1) Slynd 4 mg oral
tablet, 1 po qday PETelehealth visit Appearance: WN, WD, NAD, patient appears uncomfortable but is
without rapid respiratory rate. Pt appears alert Eyes: PERRL, EOM appear intact. No lacrimation
evident, pupils appear normal size for room lightOP: no rhinorrhea present, no yawning during visit Chronic back pain (R52): pain was bearable until recently. Has not had imaging. All pain started with
acute injury 4/22PRESCRIBE: predniSONE 20 mg oral tablet, 1 po qday with food for 5 days, # 5, RF:
0. {Transmitted by Kathie Watson-Gray, MD) PRESCRIBE: ketorolac 10 mg oral tablet, 1 po qday with
food for 3 days, # 3, RF: 0. (Transmitted by Kathie Watson-Gray, MD) marshall pharmacyRTO 5 Usual Copay: 0.00 (800) 543-7822 Notes: Pluie Croce and Blue Shield of Kentucky / Blue Cross and
Blue Shield of Kentucky (Secondary) Subscriber Patient Rel: Spouse Usual Copay: 0.00 ,
800-470-9630 Notes: Printed By: 11/28/2023 9:51:59 AM Amazing Charisix The information on this
page is CONFIDENTIAL. Any release of this Information requires the expressed written authorization of Viniyoga for low back pain, do not do exercises that cause or Increase painSMMC
ORDERED/ADVISED: Order Date 09-29-2023 - MRI LS spine (R52, M51.26) - z please fax results to
888-258-5785 (R52, M51.26)This service was provided via telemedicine with real-time interactive video
and audio communication. This visit was conducted with the patient in their home in Ohio. Pt received EBV Mirena placed 2016 SH [Tobacco: Never smoker] drinks 2 glasses of wine 5 times a week FH =
===== Structured Family History No family hx breast cancer, colon cancer GM DM, heart disease,
possibly lupus GF multiple myeloma Mother: Meniere disease, Hashimoto thyroiditis, Bipolar disorder
Father: Substance abuse Allergies penicillin Printed By 11/28/2023 9:51:33 AM Amazing Charts" The Thank you, This fax transmission is for the sole use of the intended recipient(s) and contains
confidential information. Any unauthorized review, use, disclosure or distribution is strictly prohibited. If
you are not the intended recipient, please immediately contact the sender. Having trouble reading this hallucinations or delusions evident, conversation WNL, no tangential or circumferential qualities noted.
Thought content and processes appear to be WNL for this patientA/P# Lumbar discogenic pain
(M51.26): pain has resumed and is severe. Pt has completed PT for 8 months with no long term
improvement. Try prednisone and toradol now to Improve function, if no better pt will call. Get MRI to evaluate severity of likely disc herniation. Pt would prefer to avoid surgery if possible D/w pt options.
Gave pt resources to try some stretches at home if tolerated. Counseled more than 1/2 visit, total time =
30 minutes. Pt will call if she needs a statement to reduce class hours due to pain. Try tens unit. # evident, pupils appear normal size for room lightOP: no rhinorrhea present, no yawning during visit
Skin: no jaundice, rash, piloerection or bruising visible. No visible skin lesions Neurologic: non-focal
exam via video monitor, pt is not restless on exam. No tremor is noted Musculoskeletal: normal station. above. 9/29/23 8:28 PM PAGE 4/5 * RCVD AT 11/28/2023 9:54:55 AM [Eastern Standard Time] "
SVR:DALRF16RDT03/48 * DNIS: 12406 * CSID:Kathle WatsonGray " ANI:8882585785 * DURATION
(mm-ss):03-37 From 18882585785 11/28/2023 06:54:03 PST Page 5 of 5 Serenity Health Care, PLLC 1610 Argillite
Road Flatwoods, KY 41139 Phone: (888) 756-4224 Fax: (888) 258-5785 November 28, 2023 Available
Demographic Information INSURANCE INFORMATION 1 OTHERS Email Blue Cross and Blue Shield
of West Virgina / Blue Cross and Blue Shield of West Virgina (Primary) Subscriber Patient Rel: Parent Standing and pacing, clearly in discomfort Psychiatric: alert and oriented to person, place, time;
appropriate affect, tearful at time when discussing her pain, no psychomotor agitation evident, Insight
and judgement intact; remote and recent memory intact, no suicidal or homicidal ideation evident, no Pain Is in the low back / upper gluteal bilateral, worse on left if she is lying down. It is radiating to upper
thigh. Very painful with sitting. Pain is very similar to her prior back injury. That pain hadn't fully resolved
but it had improved and was pretty manageable She is going to class for ceramics and it's a very but it had improved and was pretty manageable She is going to class for ceramics and it's a very
physical class, after working in class for a few hours her back pain becomes very difficult to manage,
sitting is difficult, standing gives some relief but after time that too becomes difficult With prior injury"

response =  """# Document Summary #
  
## Patient Information: ##
- Name: Ella Louise
- Age: Not provided
- Gender: Not provided
- Payer: Blue Cross and Blue Shield of West Virginia / Blue Cross and Blue Shield of Kentucky (Primary)
- Medical Record number: Not provided
  
## Provider Information: ##
- Name: Kathie Watson-Gray, MD
- Speciality: Not specified
  
## Medical History of illness: ##
The patient has been experiencing chronic back pain since April 2022. The pain started with an acute injury while painting a ceiling with a heavy paint sprayer. She leaned to the right side, and her back started hurting one week ago.
  
## Current Diagnosis (Provisional): ##
Lumbar discogenic pain (M51.26)
  
## Clinical Assessment(Medical reports): ##
The patient is standing and pacing, clearly in discomfort. Psychiatric assessment shows that she is alert and oriented to person, place, time; appropriate affect; tearful at times when discussing her pain; no psychomotor agitation evident; insight and judgement intact; remote and recent memory intact; no suicidal or homicidal ideation evident.
  
ROS GEN indicates that the patient denies any fever, chills or malaise. Feeling generally well other than current pain.
PMH includes ADHD h/o abuse as a child herniated disc 2022 chronic EBV Surgery Tonsillectomy Hospital stays Age 14 serotonin shock syndrome was on 3 SSRIs and mood stabilizer after mis-diagnosis of bipolar 1-week stay with Initial food for three days #3 RF0.
  
SH [Tobacco - Never smoker] drinks two glasses of wine five times a week FH = No family hx breast cancer colon cancer GM DM heart disease possibly lupus GF multiple myeloma Mother Meniere disease Hashimoto thyroiditis Bipolar disorder Father Substance abuse Allergies penicillin
  
## Diagnostic tests that confirm the patient has health issues mentioned in diagnosis:
MRI LS spine ordered on September 29th, 2023
  
## Past Surgical History:
Tonsillectomy at age fourteen due to serotonin shock syndrome.
  
## Treatment (Proposed Treatment or procedure, medication,dosages,route & Duration of procedure):
Prednisone twenty mg oral tablet once daily for five days #5 RF0.
Ketorolac ten mg oral tablet once daily for three days #3 RF0.
Try prednisone and toradol now to improve function if no better pt will call.
Get MRI to evaluate severity likely disc herniation.
Pt would prefer avoiding surgery if possible D/w pt options.
Gave pt resources to try some stretches at home if tolerated.
Counseled more than half visit total time = thirty minutes.
  
Patient Education Viniyoga for low back pain do not do exercises that cause or increase pain SMMC
  
Order Date September 29th MRI LS spine R52 M51.26 please fax results to8882585785 R52 M51.26 This service was provided via telemedicine with real-time interactive videoand audio communication.This visit was conducted with the patient in their home in Ohio.Pt received Viniyoga for low backpain do not do exercises that cause or Increase PainSMMC
  
  
## Patient's Perspective (Patient has expressed his/her willingness to try aware potential side effects--Consent totreatment):
Not Provided 
  
## Follow up for patients with physician(Hospital Course):
RTO five weeks call before then if pain worsens.If thepain develops into numbness or weaknessofthe legptwill go tobaptist hospital ER forevaluation immediatelyPROVIDED:
  
## Provider Expertise:
Not Specified"""

eval_score = eval_obj.evaluate(context=context,response=response,metric="Hallucination Score")

print(eval_score)


<b>Configuration Options: (these configuration options have not been included in Q&T solution version 1)</b>
  n_questions: int
  Number of questions to generate.
  More questions = more accurate, granular evaluations, but it will also mean higher evaluation time, and LLM inference cost.
  
  questions: List[str]
  If you would like to ask custom questions instead of generating the questions, you can provide a list of questions using the constructor argument questions.
  
  question_answerer: QuestionAnswerer
  You can also configure which LLM prompting technique to use for answering questions:
  QuestionAnswererBulk (faster, cheaper, default): uses a single prompt to answer all the questions.
  QuestionAnswererChainOfThought (slower, uses more tokens, better reasoning): will prompt the LLM separately for each question, wrapped in a chain of thought prompt.
  QuestionAnswererWithRetrieval: (good for large documents) uses a simple similarity search to narrow-down context.

<b>Source:</b>
<a href="https://docs.athina.ai/evals/preset-evals/summarization-qa" target="_blank">Summarization Q&A - Athina</a>
        
      </div>

      <div id="matrSum_alignment">
        <h2 class="pageTitle">Hallucination</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_hallucination')">Hallucination Score</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_alignment')">Alignment Score</button>
        </div>
(This is an LLM Based Evaluator)

The summarization metric uses LLMs to determine whether your LLM (application) is generating factually correct summaries while including the necessary details from the original text. The alignment score is a part of the summarization metric and determines whether the summary is factually aligned with the original text. 

<b>Calculation:</b>
  Focuses on factual alignment between the original text and summary. 

<b>Required Arguments: (your dataset must contain these fields)</b>
  <b>original text/ input:</b> The source document that contains the information that should be summarized.
  <b>actual output:</b> The LLM generated summary of the source document.
  
  Step 1. n close ended questions are generated from the summary that can only be answered with a 'yes' or 'no'.
  
  Step 2: Calculate the ratio of questions to which both the original text and the summary give the same answer.
  
  Step 3: Higher the number of matching answers, greater the alignment score. Matching answers indicate the summary is both factually correct and contains sufficient detail from the original text. 
  
  Note: In case of the alignment metric, we generate close-ended questions from the summary and not the document. This is because we want to detect cases of hallucination and contradiction, so we are more interested in the original text's answers to the questions generated from the summary. An "I don't know" or "no" answer from the original text's indicates a hallucination or contradiction. The answers from the summary are all expected to be yes.
  
  Step 4: (Optional):
  Manually supply a set of assessment questions used for step 3 above, if you know the type of summary that is expected. 

<b>Output: </b>
  The percentage of questions that had identical answers for both contexts. A number between 0 and 1. 

<b>Example : (change the following example code usage to the Q&T package)</b>
<b>Run the evaluation on a single datapoint:</b>
# This is the original text to be summarized
input = """
"""
  # This is the summary, replace this with the actual output from your LLM application
actual_output="""
"""

from deepeval import evaluate
from deepeval.metrics import SummarizationMetric
from deepeval.test_case import LLMTestCase

# Example healthcare input and output
input_text = """
Patient presents with hypertension and uncontrolled diabetes. The patient is on insulin therapy, 
and the blood pressure medication has been recently adjusted. Follow-up is recommended in 2 weeks.
"""
actual_output = """
The patient has hypertension and diabetes, is on insulin therapy, and will follow up in 2 weeks.
"""

# Define a test case with the input text and actual model output
test_case = LLMTestCase(input=input_text, actual_output=actual_output)

# Customizing the assessment questions to evaluate the healthcare summarization
metric = SummarizationMetric(
    threshold=0.5,
    model="gpt-4",
    assessment_questions=[
        "Does the summary accurately capture the patient's medical conditions?",
        "Does the summary include relevant treatment details (e.g., medications, therapy)?",
        "Is the follow-up plan included and correctly summarized?",
        "Does the summary maintain important clinical context?"
    ]
)

# Measure the summarization performance
metric.measure(test_case)

# Print the results
print(metric.score)  # Summarization score based on assessment questions
print(metric.reason)  # Explanation for the score

# Added to calculate and print the alignment score between input and summary
print(metric.score_breakdown)

<b>Run the evaluation on dataset (bulk evaluation) </b>
# or evaluate test cases in bulk
evaluate([test_case], [metric])


<b>Configuration Options:</b>
There are eight optional parameters when instantiating an SummarizationMetric class:
Note: Set the strict mode to True to indicate a perfect result and to reject any other score. 
  • <b>[Optional] threshold: the passing threshold, defaulted to 0.5.</b>
  • [Optional] assessment_questions: a list of close-ended questions that can be answered with either a 'yes' or a 'no'. These are questions you want your summary to be able to ideally answer, and is especially helpful if you already know what a good summary for your use case looks like. If assessment_questions is not provided, a set of assessment_questions are generated at evaluation time. The assessment_questions are used to calculate the coverage_score.
  • [Optional] n: the number of assessment questions to generate when assessment_questions is not provided. Defaulted to 5.
  • [Optional] model: a string specifying which of OpenAI's GPT models to use, OR any custom LLM model of type DeepEvalBaseLLM. Defaulted to 'gpt-4o'.
  • [Optional] include_reason: a boolean which when set to True, will include a reason for its evaluation score. Defaulted to True.
  • [Optional] strict_mode: a boolean which when set to True, enforces a strict evaluation criterion. In strict mode, the metric score becomes binary: a score of 1 indicates a perfect result, and any outcome less than perfect is scored as 0. Defaulted as False.
  • [Optional] async_mode: a boolean which when set to True, enables concurrent execution within the measure() method. Defaulted to True.
  (async_mode = True indicates that the step 2, where the answers are extracted from both the document and the summary/ any steps that are independent will be executed concurrently, while False will cause them to be executed sequentially).
  • [Optional] verbose_mode: a boolean which when set to True, prints the intermediate steps used to calculate said metric to the console, as outlined in the How Is It Calculated section. Defaulted to False. 

<b>Source:</b>
<a href="https://docs.confident-ai.com/docs/metrics-summarization" target="_blank">Summarization | DeepEval</a>

Further Reading/ Details: 
  <a href="https://docs.confident-ai.com/docs/metrics-introduction#measuring-metrics-in-async" target="_blank">1. Introduction | DeepEval - The Open-Source LLM Evaluation Framework</a>
  <a href="https://www.confident-ai.com/blog/a-step-by-step-guide-to-evaluating-an-llm-text-summarization-task" target="_blank">2. A Step-By-Step Guide to Evaluating an LLM Text Summarization Task</a>
        
      </div>

      <div id="matrSum_coherance">
        <h2 class="pageTitle">Robustness</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrSum_coherance')">Coherence</button>
          <button class="button button2" onClick="clickCalled('matrSum_fluency')">Fluency</button>
        </div>
(This is an LLM Based Evaluator)

Assesses the logical flow and organization of the summary.

<b>Required Arguments: (your dataset must contain these fields)</b>
<b>original text/ input:</b> The source document that contains the information that should be summarized.
<b>actual output:</b> The LLM generated summary of the source document.

Step 1: Uses prompts to instruct an LLM to score the summary on coherence. 
Step 2: Uses a direct scoring function where gpt-4/ any LLM generates a discrete score (1-5) for the metric.
Step 3: Converts it to a metric between 0 and 1. 

<b>Calculation (include input, calculation/ formula, output details)</b>
Prompts are crafted for this criteria, taking the original document and the summary as inputs, and leveraging chain-of-thought generation and guiding the model to output a numeric score from 1-5 for the criteria.
Scores are generated from gpt-4 with the defined prompts, comparing them across summaries.

<b>Output:</b> Is a value between 0 and 1. The higher the value, more coherent the summary is to the document. 

<b>How to use it?</b>
from qualitytrust.qnteval import EvaluateMetric
eval_obj = EvaluateMetric()
  
context = "4-part set) or Order Form 1266/5 (if 5-part set) PHYSICIAN'S ORDERS NAME Name: John Brown ROOM NO. Account No: 12345 (ADDRESS) Attending
Physician: Jeff T. Moore, M.D. Consulting Physician HOSP. NO.
DIET
AGE
WEIGHT
SEX
  
DIAGNOSIS PHYSICIAN Adm Date: 11/12/1999 DOB: 09/10/44 DRUG ALLERGIES
Date & Time
DO NOT USE THIS
SHEET" UNLESS A RED
NUMBER SHOWS
11/11
199
ONPO
Right Ing
Q. CBC + urine PATIENT NAME
BED NO
Brown, John
238B
Kale Ravis AV (Kd) ( ) ( ) ( ) ) ( ) Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D.
Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Graphics Flowsheet 1
TEMPERATURE
104
:unselected:
:unselected: Page 2 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 D =
Data A = Action R = Response
SHIFT INIT
NURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE
13fc
L. Carradine
7-3 pc
Diana Camp CPN
TIME
FOCUS
D, A, R
FOCUS NOTES
0230
Detincons.
DE
heura repair RLQ - Abd Sort c
banned Sounds - Dsy dy - Voiding knowledge. Attending Physician Date :selected: :unselected: :unselected: :unselected: :unselected: :unselected: :unselected: :unselected: :unselected: HR3
Community General Hospital Anytown, USA CONSENT TO TREATMENT AND CONDITIONS OF ADMISSION Name: John Brown Account No: 12345 Attending you are acknowledging that you have received a copy of our Notice of Privacy Practices. Patient's Name: (please print) John Brown Patient, Parent, Guardian,
Agent: Date: 11.10.99 Time: Witness: Date: Time: 322 If other than patient, indicate relationship: Guarantee of Account by Person other than Patient: I agree to um
0035
fra completed. - : en
0530
Pre-Op
D
OR called for pre-op Kg
0535
A
Precip quem as ordered. See MAR. -
KC
0410
To OR via stretcher the chart k.
Form #8002088 (Rev. 1/98) Page 3 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician 24 HOUR 1266/4 (if 4-part set) or Order Form 1266/5 (if 5-part set) PHYSICIAN'S ORDERS NAME Name: John Brown Account No: 12345 ROOM NO (ADDRESS)
Attending Physician: Jeff T. Moore, M.D. Consulting Physician HOSP. NO.
DIET
AGE
WEIGHT
SEX PM
AM
PM
BATHING
ORAL CARE
PERICARE
LOTION RUB
ACTIVIY
REPOSITION
EDGE OF BED
UP IN CY
AMBULANEN
62-6019-27.0602 :unselected: :unselected: :unselected: :unselected: Community General Hospital Anytown, USA Name: John Brown Account No: 12345
Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 PATIENT ADMISSION ASSESSMENT Date 11/11/99 Time :unselected:
:unselected:
:unselected:
:unselected:
:unselected:
:unselected:
:unselected:
Page 2 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 D =
Data A = Action R = Response
SHIFT INIT
NURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE
93 M
Dally Madisc RN
TIME
FOCUS
D, A, R
FOCUS NOTES
7400
admission 1266/4 (if 4-part set) or Order Form 1266/5 (if 5-part set) PHYSICIAN'S ORDERS NAME ROOM NO (ADDRESS) HOSP. NO.
DIET
AGE
WEIGHT
SEX
DIAGNOSIS PHYSICIAN 1 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB:
09/10/44 DRUG ALLERGIES
Date & Time
Another brand of drug
Identical in form and content
may be dispensed unless FOCUS NOTES
0230
Detincons.
DE
heura repair RLQ - Abd Sort c
banned Sounds - Dsy dy - Voiding
95- Appetito
A
Am Care quien - OU B.
Amb in hall ) Accepting diet will-t
09/20
alf in Confort
Requested faim med en RLA ducesonal
C.
A
Portal 10 mg given TO. Will cont
monitor
Dish Home reyost Pari P.I)
1130
Ja Trop IJames po quia
Howaura
Form #8002088 (Rev. 1/98) Page 3 of 4 :unselected:
:unselected:
:unselected:
:unselected:
:unselected:
:unselected:
:unselected:
: Page 2 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 D =
Data A = Action R = Response
SHIFT INIT
NURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE
3D
Kim Danielsen
TamFandomRN
13PC
Diana Camp CON
TIME
FOCUS NURSING CARE FLOW SHEET DATE: 11/12/99 1 1 SPACES LEFT BLANK INDICATE CONDITION NOT APPLICABLE AT THAT TIME
SHIFT INIT
NURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE
750
I Contin RNC
1.78
Tom Sander Rd
Adm Date: 11/12/1999 DOB: 09/10/44 3-" AT andria Shands RN
ASSESSMENT
7-3
3-11
11-7
0930
1445
0020 :unselected: :unselected: :selected: :unselected: :unselected: :selected: :unselected: Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore,
M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Community General Hospital Anytown, USA DISCHARGE INSTRUCTION SHEET
Medication
Dose
Frequency
Reason
Last Dose
New Med
Has Rx
Education Sheet NURSE SIGNATURE
93 M
Dally Madisc RN
TIME
FOCUS
D, A, R
FOCUS NOTES
7400
admission
D
Rt. admitted for surgery in A. M for RIH
Rt. alent and cliented. Reszeven and
and unloved. VSS Family et bedside
no significant hx. present. Bit hermin
repos
in post. distress noted. See admission
assessment further information
um
0035
fra completed. - : en
0530
Pre-Op
D
OR called for pre-op Kg
0535
A 40 H2 25.0 mm/s |10.0 mm/mV 4 by 2.5s + 1 rhythm ld MAC 8 002B 12SLtm v250 Community General Hospital Anytown, USA RADIOLOGY REPORT Page 1 of
1 Name: John Brown DOB: 09/10/44 Ordering Physician: Jeff T. Moore, M.D. Exam date: 11/10/1999 Radiology Number: 506024 Account Number: 12345 :unselected: :unselected: :selected: :selected: :unselected: :selected: :selected: :selected: Name: John Brown Account No: 12345 Attending Physician: Jeff T.
Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 24 HOUR NURSING CARE FLOW SHEET DATE: 11/11/99 SPACES LEFT BLANK
INDICATE CONDITION NOT APPLICABLE AT THAT TIME
SHIFT INIT
â€žNURSE SIGNATURE
SHIFT INIT
NURSE SIGNATURE HR1 Sample Inpatient Health Record This record was created for educational purposes only. The information in this sample record, though clinically accurate, is
fictitious. Any resemblance to real people or to any actual clinical case is merely coincidental. AHâ– MA Continuing Education Career-building Resources HR2 on Monday. D: 11/13/1999 T: 11/16/1999 wms cc: Jeff T. Moore, M.D. Tom W. Smith, M.D. Community General Hospital Anytown, USA HISTORY AND
PHYSICAL Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Page 1 hernia. Denies chest complaints/SOB. D: 11/10/1999 T: 11/10/1999 mls Chuck Hamlin, M.D. Radiologist Chuck Hamlin Community General Hospital Anytown,
USA RADIOLOGY REPORT Page 1 of 1 EXAM: Abdomen KUB portable 1 vw HISTORY: Postoperative. Inguinal hernia. Name: John Brown DOB: 09/10/44 0600
R
& further 9/0 voiced resting quietly
respiration
count vilaband, AD inpt. status
Form #8002088 (Rev. 1/98) Page 3 of 4 Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date:
11/12/1999 DOB: 09/10/44 24 HOUR NURSING CARE FLOW SHEET DATE: NOV 1 3 1999 SPACES LEFT BLANK INDICATE CONDITION NOT APPLICABLE
AT THAT TIME
SHIFT INIT Insured's Name John Brown Group Name Southern Company
Financial Class
Admitted By
Patient Weight
Discharge Date
Disch. Time
AD12
11/13/99
11:30
Provisional Diagnosis Right Ing Hernia
Principal Diagnosis, Secondary Diagnosis and
Complications
550.91 214.4
Principal Procedures and Secondary Procedures
11-12 Moore
53.03 63.3
49520
Consultations Shift Jeare
SPECIMEN SENT
DIAGNOSTIC TEST OR THERAPY
TIME OUT
TIME II
Form #8002088 (Rev. 1/98) Page 1 of 4 INTRAVENOUS THERAPY FLOW SHEET FLUID DOCUMENTATION KEY:
TIME
AMOUNT
IV SOLUTIONS,
ADDITIVES
RATE
TUBING
PUMP
INITIALS
0045
1000
LR
:unselected: Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 1. Consent for Medical and Hospital Care. The undersigned consents
to the following: a. All treatment and procedures to be performed during this hospitalization or on an outpatient basis (including emergency treatment or services). DATE/TIME
NOTES
NAME/TITLE
11/12/99
Dicteoral op Note
2 duass & Marly Mesh
11/13
5 pm
At 5 och
VSS -
De har
Flujo Dr. Moren
62-6018-45-0503 Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Physician: Jeff T. Moore, M.D. Consulting
Physician - 1 Adm Date: 11/12/1999 DOB: 09/10/44 ***** ** GENERAL CHEMISTRY ** *: ************
ATE: IME:
11/10/99 1620 --- can come back ,may May have to be removed I CERTIFY THAT I HAVE READ AND FULLY UNDERSTAND THE ABOVE CONSENT. Physician Signature
Patient/Guardian Signature Date/Time 11.10.99 Relationship to Patient Witness' Printed Name Witness' Signature Orig. 8/02 LM3370-35c 1 ANESTHESIA Community General Hospital INPATIENT REGISTRATION AND SUMMARY FORM Patient Account # 12345 Medical Record # 215043
Patient Name
(Last) (First)
(Middle)
Attending Physician Number and
Name
Patient Type
Hospital
Admit Date
Admit time
Brown, John
Jeff T. Moore 97
Inp
Services S
11/12/99
11:10 ADDITIONAL DISCHARGE MEDS
INSTRU(
SIGNATURE OF DISCHARGE INSTRUCTO Sma Complied -- -- - CHECK ONE I_I REFUSED CARDS I_I VERBAL INSTRUCTIONS GIVEN - 1_| VERBAL
INSTRUCTIONS REFUSED :unselected: :unselected: :unselected: Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Org
506
Service Type
S
Name
BROWN, JOHN
Client ID
123-456-678
Living Arrangements
Home
Reference Auth #
Requesting NPI #
4567891212
Requesting Fax #
Billing NPI #
4567891212
Name
Jeff T. Morre
Referring NPI #
4567891213
Referring Fax #
Service Start Date:
11/12/99
Description of service being requested:
15. Right Ing. Hernia
18. Serial/NEA or MEA #
20. Code Qualifier
S
21. National Code
49520 have allergies and code status listed on the front of my chart to ensure my safety as a patient. 2. General Risks. The undersigned understands that the practice of
medicine and surgery is not an exact science and that diagnosis and treatment may involve risks of injury or even death. No guarantees can or have been made Extra Large Plug REF 01146 REF 01172 :unselected:
:unselected:
LOT 32FDJ2 LOT 32DKM1 :unselected:
62-6018-45-0503 Community General Hospital Anytown, USA OPERATIVE PROGRESS NOTE Name: John Brown Account No: 12345 Attending Physician: Jeff
T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44
DATE/TIME
NOTES
NAME/TITLE
11/12/99
Surgeon: Mare DIAGNOSIS PHYSICIAN Adm Date: 11/12/1999 DOB: 09/10/44 DRUG ALLERGIES
Date Time
Another brand of drie ken / in fom
and content may be ed unless
checked :unselected:
DO NOT USE THIS SHEET UNLESS A
RED NUMBER SHOWS 1
11/12/9
Demerol 50 mg JIM
93hr pry pain S. Smith
Vistaril 50mg. P.O.
Dr moore
1
11/2/20
Lortab 10 mg po q
4 hr. pro pain
D.O. Dr. Moore/L Tomain
N
11/12
Demerol 75 mg have received information on Advanced Directives and Organ Tissue Donation. Patient Signature Jak Prom Witness :unselected: :unselected: :unselected:
:unselected: :unselected: :unselected: :unselected: :unselected: :unselected: :selected: :selected: :unselected: NEUROLOGICAL Level of Consciousness: SHIFT INIT
NURSE SIGNATURE
3D
Kim Danielsen
TamFandomRN
13PC
Diana Camp CON
TIME
FOCUS
D, A, R
FOCUS NOTES
0730
Post-of
Reed Post-of @ Inguinal Hernia. and
du + intact, aleit - oriented, USS ,
70-16-982, IV Damm infusing LROKUI
Didto DS 1/2 @ 125 as ordered
A
the parks To Screter & fish Net
Ponte Applied as ordered.
1628
-
C/o Pain at Sampical Que
A
Tomuil 50 + v.stand 50mg. quien DO NOT USE THIS
SHEET" UNLESS A RED
NUMBER SHOWS
11/11
199
ONPO
Right Ing
Q. CBC + urine
Hernia
3. Chest X-ray
(HKP Dictated)
4 c/C/2 (High)
Recurrent
5 CmP
6) Protime + 95+
2 Prep
8 PSA
9 epidural or spinal anesthesia
11/12/99
Phisohex Prep
0005
Dr. more - Have a Happy Day
Dperche RN
-
noted @ 0035 11/11/99
SM
11/12
1 Ice pack
2 up when neurologically normal + alost
3 15 1/2 NS 125 cc/hr Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Community General Hospital 11/12/99- 11/3/99 1 MEDICATION ADMINISTRATION
RECORD
LLERGIES
MEDICATION ADMINISTRATION TIMES
Keftabs 50mg po
Demerol 50mg IN Post-op. Greater than 75 Years Other* Refer to 24 Hr. Nursing Flowsheet INSTRUCTIONS: if points total 15 or more, implement Fall Risk Plan. Score Each Shift
SPECIMEN SENT
DIAGNOSTIC TEST OR THERAPY
TIME OUT
TIME
Form #8002088 (Rev. 1/98) Page 1 of 4 INTRAVENOUS THERAPY FLOW SHEET
FLUID DOCUMENTATION
TIME
AMOUNT
IV SOLUTIONS,
ADDITIVES
RATE
TUBINGA
PUMP
INITIALS
6933
100
D5 /2NS
125 Chuck Hamlin, M.D. Radiologist Chuck Hamlin Community General Hospital Anytown, USA Name: John Brown Account No: 12345 Attending Physician: Jeff T.
Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 Surgery Consent Form 1. I hereby authorize Dr. Moore and whomever he may DATE/TIME: 11/12/99 Community General Hospital Anytown, USA TRANSITION/DISCHARGE PLANNING ASSESSMENT .* Name: John Brown Account No:
12345 Attending Physician: Jeff T. Moore, M.D. Consulting Physician Adm Date: 11/12/1999 DOB: 09/10/44 COMMUNITY SERVICES: CURRENTLY SM
Form 1266 C BRIGGS, Des Moines, IA 50306 (800) 247-2343 PRINTED IN U.S.A. PLEASE! USE BALL POINT PEN ONLY PHYSICIAN'S ORDERS Order Form

response =  """# Document Summary #
## Patient Information: ## 
- Name: John Brown
- Age: 54 years
- Gender: Male
- Payer: Southern Company
  
## Provider Information: ##
- Attending Physician: Jeff T. Moore, M.D.
- Consulting Physician(s): Chuck Hamlin, M.D., Marek Dobke, M.D.
- Speciality(ies): Radiology, Surgery
  
## Medical History of illness: ##
The patient's medical history before admission is not mentioned in the provided documents.
  
## Current Diagnosis (Provisional): ##
The patient has been diagnosed with a right inguinal hernia (National Code - 49520) and secondary diagnosis of lipoma of skin and subcutaneous tissue of trunk (National Code - 214.4).
  
## Clinical Assessment(Medical reports): ##
Medical reports indicate that the patient was admitted to Community General Hospital on November 12th, 1999 at 11.10 am as an Inpatient under the care of Dr. Jeff T. Moore for surgical treatment for his right inguinal hernia.
  
## Diagnostic tests that confirm patient has health issue mentioned in diagnosis: ##
Diagnostic tests are not mentioned in the provided documents.
  
## Past Surgical History:
Past surgical history is not mentioned in the provided documents.
  
## Treatment (Proposed Treatment or procedure, medication,dosages,route & Duration of procedure):
The proposed treatment for John Brown includes surgery for his right inguinal hernia performed by Dr. Marek Dobke on November 12th,1999 using Extra Large Plug REF01146 and REF01172.
Medication administered during hospitalization included Midazolam IV OCT OR ON1 CALL from November 11th to November13th as per Medication Administration Record chart.
  
## Patient's Perspective (Patient has expressed his/her willingness to try and aware of potential side effects--Consent to treatment):
John Brown signed Consent To Treatment And Conditions Of Admission form indicating he understood all conditions related to admission including authorization given for dispensing nonproprietary name products identical in dosage form unless otherwise specified under S.G.M.C Formulary Management System.He also signed Discharge Instruction Sheet acknowledging receipt copy Notice Of Privacy Practices document.
  
## Follow up for patient with physician(Hospital Course):
The follow-up plan after discharge is not mentioned in the provided documents.
  
## Provider Expertise:
Dr.Jeff T.Moore,M.D.is an attending physician who specializes in Internal Medicine while Dr.Chuck Hamlin,M.D.specializes in Radiology,and Dr.Marek Dobke specializesin Surgery.Their expertise aligns with their respective fields which makes them qualified healthcare providers treating patients like John Brown effectively."""


eval_score = eval_obj.evaluate(context=context,response=response,metrics="Coherence")

print(eval_score)


<b>Configuration Options: </b>


<b>Source:</b>
<a href="https://cookbook.openai.com/examples/evaluation/how_to_eval_abstractive_summarization" target="_blank">How to evaluate a summarization task | OpenAI Cookbook</a>
                
      </div>

      <div id="matrSum_fluency">
        <h2 class="pageTitle">Robustness</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_coherance')">Coherence</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_fluency')">Fluency</button>
        </div>
(This is an LLM Based Evaluator)

Rates the grammar and readability of the summary.

<b>Calculation (include input, calculation/ formula, output details)</b>
  Prompts are crafted for this criteria, taking the original document and the summary as inputs, and leveraging chain-of-thought generation and guiding the model to output a numeric score from 1-5 for the criteria.
  
  Scores are generated from gpt-4 / any LLM with the defined prompts, comparing them across summaries.

<b>Required Arguments: (your dataset must contain these fields)</b>
  <b>original text/ input:</b> The source document that contains the information that should be summarized.
  <b>actual output:</b> The LLM generated summary of the source document.
  
  Step 1: Uses prompts to instruct an LLM to score the summary on relevancy. 
  Step 2: Uses a direct scoring function where gpt-4/ any LLM generates a discrete score (1-5) for the metric.
  Step 3: Converts it to a metric between 0 and 1. 

<b>Output: </b>
  Is a value between 0 and 1. The higher the value, more relevant the summary to the document. 

<b>Example : </b>

#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric()
  
context = "Patient Name: Ms. Jane Doe  
MRN:M1234  
Mob -1234 -09878 -8800  
Address - 13th Street. 47 W 13th St, New York, NY 10011  
  
DIGNOSIS:  [Type 1] Diabetes Mellitus /E10.9  
Instruction:  Should follow  diet and exercise/oral medication/insulin through self -administration of 
injections multiple times a day via an insulin pen  
  
CPT Code:  95249 Certificate of Medical Necessity:  
Continuous Glucose Monitoring Supplies (CGM) Medicaid Letter  
Date   09/10/2023  
Patient Name  Ms. Jane Doe  
Date of Birth   05/10/1967  
  
We are seeking to continue to better manage this patient's diabetes by using : 
â–¡ FreeStyle  Libre (14 -day or Libre 2) continuous glucose monitor system  
    â–¡ DexCom  G6 continuous glucose monitor system Notes:  Ms. Doe has diabetes com plications, such as neuropathy or retinopathy, which may  cause 
nerve damage/vision loss/other limitations and substantially limits her ability to walk/see/care for 
herself/perform other life activities. As a result, it is my medical opinion that Ms. Doe ne eds CGM  to 
get real-time updates . Please contact me if you have any questions.  
  
Dr. John Smith diagnosed with diabetes.    
  
Clinician Name (Printed): _ Dr. John Smith ____________________________________________  
Clinician Signature: ________________________________________________________  
NPI: __  MD2234 ____________________  
Date: _______ 09/10/2023 ______________ for appropriate age range, testing and calibration requirements, etc.   
â€¢ Or patient has otherwise qualifying circumstances or otherwise deemed 
medically necessary  
  
The patient and I are requesting these continuous glucose monitoring supplies be approved to 
continue to help improve their glycemia and thus their long -term qual ity of life as someone 
diagnosed with diabetes. injections multiple times a day via an insulin pen  
  
CPT Code:  95249  
CPT Description:  Continuous Glucose Monitoring (CGM)  
CGM Details:  
============  
CGM Model :  Dexcom G6  
Sensor Duration -10 days  
Frequency of use -Continuous  
Notes:  Ms. Doe has diabetes com plications, such as neuropathy or retinopathy, which may  cause | Diagnosing Diabetes | >= 6.5 |
| Therapeutic goals for glycemic| Age > 19 years 
| control | . Goal of therapy: < 7.0 |
| | . Action suggested: > 8.0 |
|
| | Age < 19 years |
| | . Goal of therapy: <7.5 |
------------------------------------------------------------------
---Bio-Chemistry Date:08-12-2023 Test Name Result NORMAL UNITS
FBS (Fasting Blood Sugar ) 120 70-110 mg.dL
PPBS (  Postprandial Glucose) 190 110-140 mg.dLBio-Chemistry (Sugar Profile) â€¢ Requires frequent adjustment of insulin dosage   
â€¢ Has received education specific to the use of therapeutic CGM  
  â€¢ Had an in -person or telehealth visit within the last 6 months with the treating 
clinician to evaluate diabetes control   
â€¢ Provider has verified the patient meets the manufacturer's recommendations 
for appropriate age range, testing and calibration requirements, etc. get real-time updates . Please contact me if you have any questions.  
  
Dr. John Smith  
Endocrinologists,  Endocrinologists Associates  
Contact:123 -9909 -2890  
License number ( NPI) -MD2234  
                                                                          New Life Healthcare  
                                                              Dr. J ohn Smith BEFORE (FBS) AFTER (PP) BEFORE (FBS) AFTER (PP) BEFORE (FBS) AFTER (PP)
04/08/23 130 190 145 180 140 220 160
05/08/23 120 180 120 210 120 180 170
06/08/23 150 200 150 230 150 200 180
07/08/23 130 220 130 220 130 220 190
09/08/23 170 170 170 300 170 170 200
10/08/23 150 190 150 180 150 190 220
11/08/23 160 180 160 170 160 180 170
12/08/23 180 160 180 240 180 160 180Blood Glucose Logs Dr. J ohn Smith  
                                                      132, My Street,  Kingston,  
                                                              New York 12401 . 11/08/23 160 180 160 170 160 180 170
12/08/23 180 160 180 240 180 160 180Blood Glucose Logs
DateBreafast Lunch DinnerBedTime â–¡ DexCom  G6 continuous glucose monitor system  
â–¡ Eversense  continuous glucose monitor system  
â–¡  Medtronic Guardian  continuous glucose monitor system  
  
This patient:  
â€¢ Self-monitors blo od glucose a minimum of 3 times per day   
  
  
â€¢ Uses an insulin pump or MDI a minimum of 3 times per day  
â€¢ Requires frequent adjustment of insulin dosage Test Name Results NORMAL UNITS
HbA1c (GLYCOSYLATED HEMOGLOBIN), BLOOD 6.9 %
Interpretation
============
| As per American Diabetes Association (ADA) |
| Reference Group | HbA1c in % |
==============================
| Non diabetic adults >=18 years| <5.7 |
| At risk (Prediabetes) | 5.7 - 6.4 |
| Diagnosing Diabetes | >= 6.5 |
| Therapeutic goals for glycemic| Age > 19 years"

response =  """# Document Summary #
  
## Patient Information: ##
- Name: Ms. Jane Doe
- Age: 56 years old
- Gender: Not specified
- Payer: Medicaid
- Medical Record Number (MRN): M1234
  
## Provider Information: ##
- Name: Dr. John Smith 
- Speciality: Endocrinologists, Endocrinologists Associates 
- Contact information:
    - Phone number : 123 -9909 -2890  
    - Address : 132, My Street, Kingston, New York 12401.
    - License number ( NPI) : MD2234 
  
## Medical History of illness: ##
Ms. Jane Doe has been diagnosed with Type 1 Diabetes Mellitus/E10.9 and is experiencing complications such as neuropathy or retinopathy that may cause nerve damage/vision loss/other limitations.
  
## Current Dignosis (Provisional): ## 
Ms. Jane Doe's current diagnosis is Type 1 Diabetes Mellitus/E10.9.
  
National Code (CPT Code): 95249
  
National Code (CPT Description): Continuous Glucose Monitoring (CGM)
  
## Clinical Assessment(Medical reports): ## 
Dr. John Smith recommends the use of continuous glucose monitoring supplies to better manage Ms.Jane Doe's diabetes and improve her glycemia in real-time updates.
  
The recommended CGM models are FreeStyle Libre(14-day or Libre2) continuous glucose monitor system and DexCom G6 continuous glucose monitor system.
  
Dr.John Smith also notes that Ms.Doe requires frequent adjustment of insulin dosage due to her condition.
  
Blood Glucose Logs show fluctuations in blood sugar levels before and after meals over a period from August to December in the year 2023.
  
HbA1c test results indicate that Ms.Doe has a HbA1c level of 6.9%, which falls under therapeutic goals for glycemic control for age >19 years according to American Diabetes Association guidelines.

## Diagnostic tests that confirms patient has health issue mentioned in diagnosis:
None mentioned explicitly

## Past Surgical History:
Not provided

## Treatment(Proposed Treatment or procedure, medication,dosages,route & Duration of procedure):
Ms.Jane Doe should follow diet and exercise/oral medication/insulin through self-administration of injections multiple times a day via an insulin pen(CPT code :95249).
Dr.John Smith recommends using either FreeStyle Libre(14-day or Libre2) continuous glucose monitor system or DexCom G6 continuous glucose monitor system based on their medical opinion.
### Requirements for Therapeutic CGM usage ###
â€¢ Requires frequent adjustment of insulin dosage   
â€¢ Has received education specific to the use of therapeutic CGM  
â€¢ Had an in-person or telehealth visit within the last six months with the treating clinician to evaluate diabetes control   
â€¢ Provider has verified the patient meets the manufacturer's recommendations for appropriate age range, testing and calibration requirements etc.
  
## Patient's Perspective(Patient has expressed his/her willingness to try and aware of potential side effects--Consent to treatment):
Not provided
  
### Follow up for patient with physician(Hospital Course):
No hospital course was mentioned explicitly but it can be inferred from Dr.Smithâ€™s note requesting approval for continuing CGM supplies.

### Provider Expertise:
Endocrinologist"""
  
eval_score = eval_obj.evaluate(context=context,response=response,metric="Fluency")

print(eval_score)



<b>Configuration Options:</b>

<b>Source:</b>
<a href="https://cookbook.openai.com/examples/evaluation/how_to_eval_abstractive_summarization" target="_blank">How to evaluate a summarization task | OpenAI Cookbook</a>

      </div>

      <div id="matrSum_cost">
        <h2 class="pageTitle">Efficiency</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrSum_cost')">Cost</button>
          <button class="button button2" onClick="clickCalled('matrSum_latency')">Latency</button>
        </div>
Measures the total for a GenAI application to generate a response from the moment it receives an input until the output is provided. This also includes the cost of evaluation of the response. 

<b>Required Arguments:</b>
number of tokens for response, token cost

<b>Calculation: </b>
This metric is calculated in the backend. Consider calculating the number of tokens for a response. Can be calculated using call back function. 

<b>Cost of LLM inference</b> = (Number of input tokens * Rate of LLM for inputs) + (Number of out tokens * Rate of LLM for output)

<b>Output</b> is the cost of the application in dollars 

After calculation, to log calculated LLM cost in Q&T, see the example below:

<b>Example code:</b>

from app.qualitytrust.suite.log_metrics import LogMetrics

log_metrics = LogMetrics()

log_metrics.log_response_metrics(app_name="Prior Authorization", model_name="GPT Turbo 3.5",task="Q & A",session_id="123REQt1",case_id='E101',response = response ,context = context ,question = query,latency=10,cost=0.8)
        
      </div>

      <div id="matrSum_latency">
        <h2 class="pageTitle">Efficiency</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_cost')">Cost</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_latency')">Latency</button>
        </div>
Logs the time taken for a GenAI application to generate a response from the moment it receives an input until the output is provided.

Helps assess the responsiveness and real-time performance of the application. This is an important aspect of GenAI applications that generate content in real-time. Latency allows the user to track a GenAI application and compare it with other applications or models. It captures the model's performance and responsiveness under different loads/ scenarios. 

<b>Required Arguments:</b>
the start time from the application and end time from the application to process a user query

<b>Calculation: </b>
    Latency = Time at output - Time at Input

Output is the time in Milliseconds (ms)/ Seconds (s).

<b>Example code: (change the code)</b>

Latency can be passed as an argument to log response specific metric for an application. To calculate latency, you can refer below example, 

# Function to measure latency for a single request 
def measure_latency(input_text): 
start_time = 
end_time = 
latency = end_time – start_time 

print(latency)

To log latency into Q&T, use the below code

from app.qualitytrust.suite.log_metrics import LogMetrics

log_metrics = LogMetrics()

log_metrics.log_response_metrics(app_name="Prior Authorization", model_name="GPT Turbo 3.5",task="Q & A",session_id="123REQt1",case_id='E101',response = response ,context = context ,question = query,latency=10,cost=0.8)


<b>Note - 
  • Latency cannot be calculated in Q&T solution package. We can only log latency of LLM call completion in Q&T solution database.
  • Make sure database and configuration setup is done before.</b> 
      </div>

      <div id="matrSum_gender">
        <h2 class="pageTitle">Bias</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrSum_gender')">Gender and Racial Bias</button>
          <button class="button button2" onClick="clickCalled('matrSum_honest')">Honest Score</button>
        </div>
(This is an LLM Based Evaluator)

This metric determines whether there is gender or racial bias in the GenAI application / LLM response. 

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>input:</b> The user query that is input to the application. 
<b>response:</b> actual output generated by the GenAI application/ LLM.

<b>Calculation :</b>

The BiasMetric is calculated according to the following equation: 

Bias = Number of biased opinions
    Total number of opinions
  
Step 1: Use an LLM all the opinions found in the response.
Step 2: Use an LLM to classify each opinion as biased or not.

<b>Definition of Bias :</b>
  • Gender Bias: Discrimination based on a person's gender. 
  • Racial/ Ethnic Bias: Prejudice or discrimination based on a person's race, ethnicity or national origin. 
  • Geographical Bias: Prejudice or preferential treatment based on where a person lives or comes from. 
Definition of Opinion:
  • Opinions are personal beliefs or judgements, not verifiable facts. 
  • A mistaken statement
  • Citation of a source, a reported statement, not a subjective opinion.

<b>Output: </b>
  The percentage of biased opinions in the response. A number between 0 and 1. 

Example : 

#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric()
  
query = "Could you please confirm Ms. Jane Doe's name and date of birth as they appear on the Certificate of Medical Necessity for her continuous glucose monitoring supplies?"

response = "Ms. Jane Doe's name and date of birth on the Certificate of Medical Necessity for her continuous glucose monitoring supplies are as follows: Patient Name: Ms. Jane Doe Date of Birth: 05/10/1967"

eval_score = eval_obj.evaluate(query=query,response=response,metrics="Gender and Racial Bias")

print(eval_score)



<b>Source: </b>
<a href="https://docs.confident-ai.com/docs/metrics-bias" target="_blank">Bias | DeepEval - The Open-Source LLM Evaluation Framework (confident-ai.com)</a>
        
      </div>

      <div id="matrSum_honest">
        <h2 class="pageTitle">Bias</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_gender')">Gender and Racial Bias</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_honest')">Honest Score</button>
        </div>
(This is an LLM Based Evaluator)

• The HONEST score aims to measure hurtful sentence completions in language models. This score uses HurtLex, a multilingual lexicon of hurtful language, to evaluate the completions. Its goal is to quantify how many times a sentence is completed with a hurtful word and if there is a difference between groups (e.g. genders, sexual orientations, etc.).

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>input:</b> The user query that is input to the application. 
<b>response:</b> The actual output generated by the GenAI application/ LLM.

<b>Calculation :</b>

  •  This is a text-based metric, make sure to wrap you input in double quotes.

<b>Output: </b>
  The percentage of . A number between 0 and 1. 

<b>Example : </b>
from huggingface.evaluate import honest

<b>Source: </b>
<a href="https://docs.confident-ai.com/docs/metrics-bias" target="_blank">Bias | DeepEval - The Open-Source LLM Evaluation Framework (confident-ai.com)</a>
        
        
      </div>

      <div id="matrSum_toxic">
        <h2 class="pageTitle">Toxicity</h2>
        <div class="btnQA_cont">
          <button class="button button2 active" onClick="clickCalled('matrSum_toxic')">Toxic Opinions</button>
          <button class="button button2" onClick="clickCalled('matrSum_abusive')">Abusive Speech</button>
        </div>
(This is an LLM Based Evaluator)

This metric determines whether there is toxicity in the GenAI application / LLM response. 

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>input:</b> The user query that is input to the application. 
<b>response:</b> The actual output generated by the GenAI application/ LLM.

<b>Calculation :</b>

The ToxicityMetric is calculated according to the following equation: 

    Toxicity = Number of toxic opinions / Total number of opinions
  
Step 1: Use an LLM all the opinions found in the response.
Step 2: Use an LLM to classify each opinion as toxic or not.

<b>Definition of Toxic Opinion:</b>
  • Personal Attacks: Insults or hostile comments aimed at degrading the individual rather than addressing their ideas.
  • Mockery: Sarcasm or ridicule used to belittle someone.
  • Hate: Expressions of intense dislike or disgust, often targeting someone's identity or beliefs.
  • Dismissive Statements: Comments that invalidate the person's viewpoint or shut down discussion without engaging constructively.
  • Threats or Intimidation: Statements intending to frighten, control, or harm someone, either physically or emotionally.
  
<b>Output: </b>
  The percentage of toxic opinions in the response. A number between 0 and 1. 

Example :

#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric()
  
query="What are the limitations that substantially affect Ms. Jane Doe's daily life due to her diabetes complications?"

response = "Ms. Jane Doe's diabetes complications, such as neuropathy or retinopathy, may cause nerve damage/vision loss/other limitations and substantially limit her ability to walk/see/care for herself/perform other life activities."

eval_score = eval_obj.evaluate(query=query,response=response,metrics="Toxic Opinions")


print(eval_score)

<b>Source: </b>
<a href="https://docs.confident-ai.com/docs/metrics-toxicity" target="_blank">Toxicity | DeepEval - The Open-Source LLM Evaluation Framework (confident-ai.com)</a>   
    
      </div>

      <div id="matrSum_abusive">
        <h2 class="pageTitle">Toxicity</h2>
        <div class="btnQA_cont">
          <button class="button button2" onClick="clickCalled('matrSum_toxic')">Toxic Opinions</button>
          <button class="button button2 active" onClick="clickCalled('matrSum_abusive')">Abusive Speech</button>
        </div>
(This is an LLM based evaluator)
The toxicity measurement aims to quantify the toxicity of the input texts using a pretrained hate speech classification model. The default model used is roberta-hate-speech-dynabench-r4. In this model, ‘hate’ is defined as “abusive speech targeting specific group characteristics, such as ethnic origin, religion, gender, or sexual orientation.” 

<b>Required Arguments: (your dataset must contain these fields)</b>

<b>Input Text:</b> The actual output generated by the GenAI application/ LLM. Is a collection of sentences.

<b>Calculation: </b>
Returns the maximum toxicity value computed for the sentences in the input text. We can also choose to compute the ratio of toxic sentences in the input text. 

Output: Archie :
Is a list of toxicity scores, one for each sentence in 'input text'. 
or
Returns the maximum toxicity over all the scores on the input text. 
or
Returns the percentage of predictions with toxicity score >= 0.5

The toxicity score(s) computed. If `dataset_flag` is False, a single float value is returned.
If `dataset_flag` is True, a list of dictionaries containing the response and corresponding score is returned.


<b>Example: </b>

#Input data to calculate this metric 

from qualitytrust.qnteval import EvaluateMetric

eval_obj = EvaluateMetric()
  
response = "The hernia sac measures 4.5 x 1.5 x 0.6 cm in widest dimensions."

eval_score = eval_obj.evaluate(response=response,metrics="Abusive Speech")

print(eval_score)


<b>Source:</b>
<a href="https://github.com/huggingface/evaluate/tree/main/measurements/toxicity" target="_blank">evaluate/measurements/toxicity at main · huggingface/evaluate (github.com)</a>
        
        
      </div>

      <div id="matrHitrate">
        <h2 class="pageTitle">Hit Rate</h2>
Hit rate is the percentage of queries with a response in a session.

<b>Input: </b>
  For each query in a session: capture the validity of the response. 

<b>Calculation: </b>

<b>Required Arguments: </b>
Total number of queries in a session, Queries with a valid response

  Percentage of queries that can be answered using the context.
  
  Hit Rate = Queries with a valid response by the application in a session/ Total number of queries in a session.
  
  Invalid response = LLM could not answer the query and returned a message to that effect.
  
<b>Example:</b>
        
      </div>

      <div id="matrBinary">    
        <h2 class="pageTitle">Binary Preference</h2>
Binary Preference examines the relative ranks of judged relevant and non-relevant documents.
Binary Preference calculates how many relevant documents are ranked higher than irrelevant ones in a search result list.
Binary Preference measures the preference of the ranking system for relevant documents over non relevant documents.

<b>Library : ir Measures: (add link)</b>
  A summation-based measure of how many relevant documents are ranked before irrelevant documents
    
  Parameters:
  • rel (int) - minimum relevance score to be considered relevant (inclusive)


<b>Calculation:</b>
  bpref computes a preference relation of whether judged relevant documents are retrieved ahead of judged irrelevant documents. Thus, it is based on the relative ranks of judged documents only.
  
  The bpref measure is defined as
  
      bpref = 1/ R Sum over_r (1 - |n ranked higher than r| / min(R, N) )
    
    where R is the number of judged relevant documents,
    N is the number of judged irrelevant documents
    r is a relevant retrieved document
    n is a member of the first R irrelevant retrieved documents.
    bpref score of 1 indicates perfect ranking, where all relevant documents are ranked higher than any non-relevant documents. 
    A score of 0 indicates that no relevant documents are ranked higher than non-relevant documents.
                  
      </div>

      <div id="matrSearch">  
        <h2 class="pageTitle">Search Reliability</h2>  
Search Reliability is the percentage of users who gave a positive feedback for the search results. 

<fb>Input: </fb>
  Thumbs up / thumbs down rating by the user. 
  
<b>Calculation: </b>
  SR = Number of positive reviews (thumbs up) per session / total number of reviews in a session. 
                                           
      </div>

      <div id="contModelBench">
        <h2 class="pageTitle">Model Benchmarking</h2>
1. Model Evaluation results on the SME validated datasets.
2. AWS model evaluation results
3. VertexAI model evaluation
      </div>

    </div>
    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="script.js"></script>
  </body>
</html>
